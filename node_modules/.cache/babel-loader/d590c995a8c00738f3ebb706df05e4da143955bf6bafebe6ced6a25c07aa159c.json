{"ast":null,"code":"var _jsxFileName = \"C:\\\\CA\\\\pks\\\\src\\\\BillingPanel.jsx\",\n  _s = $RefreshSig$();\n// src/BillingPanel.jsx\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport * as XLSX from \"xlsx\";\nimport \"./BillingPanel.css\";\nimport { apiBillingSuggest, apiCheckAvailability, apiPurchasesLast, apiCreateSaleFIFO, apiAccountsSuggest, apiAccountByMobile, apiAccountsSuggestName, apiAccountById } from \"./api\";\n\n// ---- helpers (scoped to panel) ----\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst emptyLine = () => ({\n  itemName: \"\",\n  qty: \"\",\n  unitPrice: \"\",\n  hsn: \"\",\n  gst: \"\",\n  unit: \"KG\"\n});\nconst fmtDDMMYYYY = iso => {\n  const d = new Date(iso);\n  const dd = String(d.getDate()).padStart(2, \"0\");\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  const yy = d.getFullYear();\n  return `${dd}-${mm}-${yy}`;\n};\nfunction toINR(n) {\n  const v = isNaN(n) ? 0 : n;\n  return v.toLocaleString(\"en-IN\", {\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2\n  });\n}\nfunction numberToWordsIndian(num) {\n  const a = [\"\", \"One\", \"Two\", \"Three\", \"Four\", \"Five\", \"Six\", \"Seven\", \"Eight\", \"Nine\", \"Ten\", \"Eleven\", \"Twelve\", \"Thirteen\", \"Fourteen\", \"Fifteen\", \"Sixteen\", \"Seventeen\", \"Eighteen\", \"Nineteen\"];\n  const b = [\"\", \"\", \"Twenty\", \"Thirty\", \"Forty\", \"Fifty\", \"Sixty\", \"Seventy\", \"Eighty\", \"Ninety\"];\n  function inWords(n) {\n    if (n < 20) return a[n];\n    if (n < 100) return b[Math.floor(n / 10)] + (n % 10 ? \" \" + a[n % 10] : \"\");\n    if (n < 1000) return a[Math.floor(n / 100)] + \" Hundred\" + (n % 100 ? \" and \" + inWords(n % 100) : \"\");\n    return \"\";\n  }\n  if (num === 0) return \"Zero\";\n  const parts = [];\n  const units = [[\"Crore\", 10000000], [\"Lakh\", 100000], [\"Thousand\", 1000], [\"\", 1]];\n  let n = Math.floor(num);\n  for (const [label, value] of units) {\n    const q = Math.floor(n / value);\n    if (q) {\n      if (value >= 1000) {\n        if (q < 100) parts.push(inWords(q) + \" \" + label);else parts.push(numberToWordsIndian(q) + \" \" + label);\n      } else {\n        parts.push(inWords(q));\n      }\n      n = n % value;\n    }\n  }\n  return parts.join(\" \");\n}\nfunction escapeHtml(s) {\n  return String(s || \"\").replaceAll(\"&\", \"&amp;\").replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\").replaceAll('\"', \"&quot;\").replaceAll(\"'\", \"&#039;\");\n}\nconst normCode = v => String(v || \"\").trim();\n\n// small numeric helper\nconst n = v => isNaN(Number(v)) || !v ? 0 : Number(v);\n// Mobile-based typeahead (accounts_list)\n\n/** Billing panel */\nexport default function BillingPanel({\n  company,\n  defaultBank,\n  inventory\n}) {\n  _s();\n  // Buyer / consignee / meta\n  // Payment receipt reference\n  // ADDED PAYMENT RECEIPT NO\n  const [paymentReceiptNo, setPaymentReceiptNo] = useState(\"\");\n  const [buyer, setBuyer] = useState({\n    account_id: null,\n    name: \"\",\n    mobile: \"\",\n    addr1: \"\",\n    addr2: \"\",\n    city: \"\",\n    pin: \"\",\n    state: \"\",\n    stateCode: \"\",\n    gstin: \"\",\n    email: \"\",\n    phone: \"\"\n  });\n\n  // Selected account (ledger)\n  const [selectedAccount, setSelectedAccount] = useState(null);\n  const [invoiceType, setInvoiceType] = useState(\"B2C\"); // default\n\n  // Account search\n  const [accQuery, setAccQuery] = useState(\"\");\n  const [accSuggest, setAccSuggest] = useState([]);\n  const accDebRef = useRef();\n  const normalizeAccount = a => {\n    var _ref, _a$account_id, _ref2, _a$name;\n    return {\n      ...a,\n      account_id: (_ref = (_a$account_id = a.account_id) !== null && _a$account_id !== void 0 ? _a$account_id : a.id) !== null && _ref !== void 0 ? _ref : null,\n      name: (_ref2 = (_a$name = a.name) !== null && _a$name !== void 0 ? _a$name : a.account_name) !== null && _ref2 !== void 0 ? _ref2 : \"\"\n    };\n  };\n  useEffect(() => {\n    // ðŸš« HARD STOP: ledger already selected\n    if (selectedAccount) {\n      setAccSuggest([]);\n      return;\n    }\n    clearTimeout(accDebRef.current);\n    accDebRef.current = setTimeout(async () => {\n      const q = (accQuery || \"\").trim();\n      if (q.length < 2) {\n        setAccSuggest([]);\n        return;\n      }\n      try {\n        const rows = await apiAccountsSuggestName(q, 10);\n        setAccSuggest((rows || []).map(normalizeAccount));\n      } catch {\n        setAccSuggest([]);\n      }\n    }, 180);\n    return () => clearTimeout(accDebRef.current);\n  }, [accQuery, selectedAccount]);\n\n  /*\r\n    useEffect(() => {\r\n    clearTimeout(accDebRef.current);\r\n    accDebRef.current = setTimeout(async () => {\r\n      const q = (accQuery || \"\").trim();\r\n      if (q.length < 2) return setAccSuggest([]);\r\n      try {\r\n        const rows = await apiAccountsSuggestName(q, 10);\r\n        setAccSuggest((rows || []).map(normalizeAccount));\r\n      } catch {\r\n        setAccSuggest([]);\r\n      }\r\n    }, 180);\r\n      return () => clearTimeout(accDebRef.current);\r\n  }, [accQuery]);\r\n    */\n  // Payments\n  const [advance, setAdvance] = useState(\"0\"); // kept in state, but field hidden now\n  const [paymentMode, setPaymentMode] = useState(\"\");\n  const paymentModes = [\"Select\", \"Cash\", \"UPI\", \"Card\", \"Bank Transfer\", \"Cheque\", \"Credit\", \"Online\"];\n\n  // Split payments\n  const [splitEnabled, setSplitEnabled] = useState(false);\n  const [split1, setSplit1] = useState({\n    amount: \"\",\n    mode: \"Select\",\n    ref: \"\"\n  });\n  const [split2, setSplit2] = useState({\n    amount: \"\",\n    mode: \"Select\",\n    ref: \"\"\n  });\n  const [consigneeDifferent, setConsigneeDifferent] = useState(false);\n  const [consignee, setConsignee] = useState({\n    ...buyer\n  });\n  useEffect(() => {\n    if (!consigneeDifferent) setConsignee({\n      ...buyer\n    });\n  }, [consigneeDifferent, buyer]);\n  const todayIso = new Date().toISOString().slice(0, 10);\n  const [invMeta, setInvMeta] = useState({\n    invoiceNo: \"PKS-B-00001\",\n    date: todayIso,\n    ewayNo: \"\",\n    vehicleNo: \"\",\n    kms: \"\",\n    fromDate: \"\",\n    toDate: \"\",\n    lrDate: todayIso\n  });\n\n  // lines + discount\n  const [lines, setLines] = useState([emptyLine()]);\n  const [discountPct, setDiscountPct] = useState(\"0\");\n\n  // Purchases-based type-ahead\n  const [suggest, setSuggest] = useState([]); // [{name}]\n  const [activeQuery, setActiveQuery] = useState(\"\");\n  const debRef = useRef();\n  useEffect(() => {\n    clearTimeout(debRef.current);\n    debRef.current = setTimeout(async () => {\n      const q = (activeQuery || \"\").trim();\n      if (!q) return setSuggest([]);\n      try {\n        const list = await apiBillingSuggest(q, 25);\n        setSuggest(list || []);\n      } catch {\n        setSuggest([]);\n      }\n    }, 180);\n    return () => clearTimeout(debRef.current);\n  }, [activeQuery]);\n  const [mobileSuggest, setMobileSuggest] = useState([]); // rows from backend\n  const [mobileQuery, setMobileQuery] = useState(\"\");\n  const mobDebRef = useRef();\n  useEffect(() => {\n    clearTimeout(mobDebRef.current);\n    mobDebRef.current = setTimeout(async () => {\n      const q = (mobileQuery || \"\").trim();\n      if (q.length < 2) return setMobileSuggest([]);\n      try {\n        const rows = await apiAccountsSuggest(q, 10);\n        setMobileSuggest((rows || []).map(normalizeAccount));\n      } catch {\n        setMobileSuggest([]);\n      }\n    }, 180);\n    return () => clearTimeout(mobDebRef.current);\n  }, [mobileQuery]);\n  const [nameSuggest, setNameSuggest] = useState([]);\n  const [nameQuery, setNameQuery] = useState(\"\");\n  const nameDebRef = useRef();\n  useEffect(() => {\n    clearTimeout(nameDebRef.current);\n    nameDebRef.current = setTimeout(async () => {\n      const q = (nameQuery || \"\").trim();\n      if (q.length < 2) return setNameSuggest([]);\n      try {\n        const rows = await apiAccountsSuggestName(q, 10);\n        setNameSuggest((rows || []).map(normalizeAccount));\n      } catch {\n        setNameSuggest([]);\n      }\n    }, 180);\n    return () => clearTimeout(nameDebRef.current);\n  }, [nameQuery]);\n  useEffect(() => {\n    if (invoiceType === \"B2C\") {\n      setBuyer(b => ({\n        ...b,\n        gstin: \"\"\n      }));\n    }\n  }, [invoiceType]);\n  const pickName = async acc => {\n    if (!acc) return;\n    setNameQuery(acc.name || \"\");\n    setNameSuggest([]);\n    try {\n      var _ref3, _full$account_id, _ref4, _full$name;\n      // ðŸ”‘ Resolve FULL ledger by ID (or mobile fallback)\n      let full = null;\n      if (acc.account_id || acc.id) {\n        var _acc$account_id;\n        full = await apiAccountById((_acc$account_id = acc.account_id) !== null && _acc$account_id !== void 0 ? _acc$account_id : acc.id);\n      } else if (acc.mobile) {\n        full = await apiAccountByMobile(acc.mobile);\n      }\n      if (!full) return;\n      const normalized = {\n        ...full,\n        account_id: (_ref3 = (_full$account_id = full.account_id) !== null && _full$account_id !== void 0 ? _full$account_id : full.id) !== null && _ref3 !== void 0 ? _ref3 : null,\n        name: (_ref4 = (_full$name = full.name) !== null && _full$name !== void 0 ? _full$name : full.account_name) !== null && _ref4 !== void 0 ? _ref4 : \"\"\n      };\n\n      // âœ… SINGLE SOURCE OF TRUTH\n      setSelectedAccount(normalized);\n      setAccQuery(normalized.name);\n      fillBuyerFromAccount(normalized);\n    } catch (e) {\n      console.error(\"pickName failed:\", e);\n    }\n  };\n  const pickAccount = async acc => {\n    console.log(\"Clicked account:\", acc);\n    if (!(acc !== null && acc !== void 0 && acc.account_id)) return;\n    try {\n      var _ref5, _full$name2;\n      const full = await apiAccountById(acc.account_id);\n      if (!full) return;\n      const normalized = {\n        ...full,\n        name: (_ref5 = (_full$name2 = full.name) !== null && _full$name2 !== void 0 ? _full$name2 : full.account_name) !== null && _ref5 !== void 0 ? _ref5 : \"\"\n      };\n      setSelectedAccount(normalized);\n      setAccQuery(normalized.name);\n      fillBuyerFromAccount(normalized);\n    } catch (e) {\n      console.error(\"Account fetch failed\", e);\n    } finally {\n      setAccSuggest([]);\n    }\n  };\n  const fillBuyerFromAccount = acc => {\n    var _ref6, _acc$account_id2, _ref7, _acc$account_name, _acc$mobile;\n    if (!acc) return;\n    const normalized = {\n      account_id: (_ref6 = (_acc$account_id2 = acc.account_id) !== null && _acc$account_id2 !== void 0 ? _acc$account_id2 : acc.id) !== null && _ref6 !== void 0 ? _ref6 : null,\n      name: (_ref7 = (_acc$account_name = acc.account_name) !== null && _acc$account_name !== void 0 ? _acc$account_name : acc.name) !== null && _ref7 !== void 0 ? _ref7 : \"\",\n      mobile: (_acc$mobile = acc.mobile) !== null && _acc$mobile !== void 0 ? _acc$mobile : \"\"\n    };\n    console.log(\"fillBuyerFromAccount acc:\", acc);\n    setBuyer(b => {\n      var _acc$mobile2, _acc$addr, _acc$addr2, _acc$city, _ref8, _acc$pin, _acc$state, _ref9, _acc$stateCode, _acc$gstin, _acc$email, _acc$phone;\n      return {\n        ...b,\n        account_id: normalized.account_id,\n        name: normalized.name,\n        mobile: (_acc$mobile2 = acc.mobile) !== null && _acc$mobile2 !== void 0 ? _acc$mobile2 : b.mobile,\n        addr1: (_acc$addr = acc.addr1) !== null && _acc$addr !== void 0 ? _acc$addr : b.addr1,\n        addr2: (_acc$addr2 = acc.addr2) !== null && _acc$addr2 !== void 0 ? _acc$addr2 : b.addr2,\n        city: (_acc$city = acc.city) !== null && _acc$city !== void 0 ? _acc$city : b.city,\n        pin: String((_ref8 = (_acc$pin = acc.pin) !== null && _acc$pin !== void 0 ? _acc$pin : b.pin) !== null && _ref8 !== void 0 ? _ref8 : \"\").replace(/[^0-9]/g, \"\"),\n        state: (_acc$state = acc.state) !== null && _acc$state !== void 0 ? _acc$state : b.state,\n        stateCode: String((_ref9 = (_acc$stateCode = acc.stateCode) !== null && _acc$stateCode !== void 0 ? _acc$stateCode : b.stateCode) !== null && _ref9 !== void 0 ? _ref9 : \"\").replace(/[^0-9]/g, \"\"),\n        gstin: (_acc$gstin = acc.gstin) !== null && _acc$gstin !== void 0 ? _acc$gstin : b.gstin,\n        email: (_acc$email = acc.email) !== null && _acc$email !== void 0 ? _acc$email : b.email,\n        phone: (_acc$phone = acc.phone) !== null && _acc$phone !== void 0 ? _acc$phone : b.phone\n      };\n    });\n\n    // âœ… THIS IS THE MISSING LINK\n    setSelectedAccount(normalized);\n    setAccQuery(normalized.name);\n  };\n  // per-line availability status: { exists, stock, can_deliver }\n  const [statuses, setStatuses] = useState({});\n  const updateAvailability = async (idx, name, qty) => {\n    const vname = (name || \"\").trim();\n    const q = Number(qty !== null && qty !== void 0 ? qty : 0);\n    if (!vname) {\n      setStatuses(s => ({\n        ...s,\n        [idx]: undefined\n      }));\n      return;\n    }\n    try {\n      const st = await apiCheckAvailability(vname, Number.isFinite(q) ? q : 0);\n      setStatuses(s => ({\n        ...s,\n        [idx]: st\n      }));\n    } catch {\n      setStatuses(s => ({\n        ...s,\n        [idx]: undefined\n      }));\n    }\n  };\n  const lookupFromInventory = val => {\n    const arr = Array.isArray(inventory) ? inventory : [];\n    const byLower = s => String(s || \"\").toLowerCase();\n    let found = arr.find(i => byLower(i.name) === byLower(val));\n    if (found) {\n      var _ref0, _ref1, _found$hsn, _ref10, _found$gst, _ref11, _found$unit, _ref12, _found$price;\n      return {\n        name: found.name,\n        hsn: (_ref0 = (_ref1 = (_found$hsn = found.hsn) !== null && _found$hsn !== void 0 ? _found$hsn : found[\"HSN\"]) !== null && _ref1 !== void 0 ? _ref1 : found[\"HSN CODE\"]) !== null && _ref0 !== void 0 ? _ref0 : \"\",\n        gst: Number((_ref10 = (_found$gst = found.gst) !== null && _found$gst !== void 0 ? _found$gst : found[\"GST %\"]) !== null && _ref10 !== void 0 ? _ref10 : 0) || 0,\n        unit: (_ref11 = (_found$unit = found.unit) !== null && _found$unit !== void 0 ? _found$unit : found[\"UNIT\"]) !== null && _ref11 !== void 0 ? _ref11 : \"KGS\",\n        price: Number((_ref12 = (_found$price = found.price) !== null && _found$price !== void 0 ? _found$price : found[\"PRICE\"]) !== null && _ref12 !== void 0 ? _ref12 : 0) || 0\n      };\n    }\n    const f2 = arr.find(i => byLower(i[\"ITEM NAME\"]) === byLower(val));\n    if (f2) {\n      var _ref13, _f2$HSN, _f2$GST, _f2$UNIT, _f2$PRICE;\n      return {\n        name: f2[\"ITEM NAME\"],\n        hsn: (_ref13 = (_f2$HSN = f2[\"HSN\"]) !== null && _f2$HSN !== void 0 ? _f2$HSN : f2[\"HSN CODE\"]) !== null && _ref13 !== void 0 ? _ref13 : \"\",\n        gst: Number((_f2$GST = f2[\"GST %\"]) !== null && _f2$GST !== void 0 ? _f2$GST : 0) || 0,\n        unit: (_f2$UNIT = f2[\"UNIT\"]) !== null && _f2$UNIT !== void 0 ? _f2$UNIT : \"KGS\",\n        price: Number((_f2$PRICE = f2[\"PRICE\"]) !== null && _f2$PRICE !== void 0 ? _f2$PRICE : 0) || 0\n      };\n    }\n    return null;\n  };\n  const handleItemChange = async (idx, val) => {\n    var _lines$idx;\n    setActiveQuery(val);\n    let picked = null;\n    try {\n      if ((val || \"\").trim()) {\n        picked = await apiPurchasesLast(val.trim());\n      }\n    } catch {\n      /* ignore */\n    }\n    if (!picked) {\n      const item = lookupFromInventory(val);\n      picked = item ? {\n        name: item.name,\n        hsn: item.hsn || \"\",\n        price: Number(item.price || 0),\n        gst: Number(item.gst || 0),\n        stockQty: 0\n      } : null;\n    }\n    setLines(prev => {\n      const next = prev.map((r, i) => {\n        var _picked$hsn, _picked, _picked$price, _picked2, _picked$gst, _picked3;\n        return i !== idx ? r : {\n          ...r,\n          itemName: val,\n          hsn: (_picked$hsn = (_picked = picked) === null || _picked === void 0 ? void 0 : _picked.hsn) !== null && _picked$hsn !== void 0 ? _picked$hsn : r.hsn,\n          unit: \"KG\",\n          unitPrice: String((_picked$price = (_picked2 = picked) === null || _picked2 === void 0 ? void 0 : _picked2.price) !== null && _picked$price !== void 0 ? _picked$price : r.unitPrice),\n          gst: String((_picked$gst = (_picked3 = picked) === null || _picked3 === void 0 ? void 0 : _picked3.gst) !== null && _picked$gst !== void 0 ? _picked$gst : r.gst)\n        };\n      });\n      const isNonEmpty = !!(next[idx].itemName || next[idx].qty);\n      const hasBlank = next.length && !next[next.length - 1].itemName && !next[next.length - 1].qty;\n      if (isNonEmpty && !hasBlank) next.push(emptyLine());\n      return next;\n    });\n    const qtyNow = Number(((_lines$idx = lines[idx]) === null || _lines$idx === void 0 ? void 0 : _lines$idx.qty) || 0);\n    updateAvailability(idx, val, qtyNow);\n    setSuggest([]);\n  };\n  const handleQty = (idx, v) => {\n    var _lines$idx2;\n    const clean = String(v).replace(/[^0-9.]/g, \"\");\n    setLines(prev => {\n      const next = prev.map((r, i) => i !== idx ? r : {\n        ...r,\n        qty: clean\n      });\n      const isNonEmpty = !!(next[idx].itemName || clean);\n      const hasBlank = next.length && !next[next.length - 1].itemName && !next[next.length - 1].qty;\n      if (isNonEmpty && !hasBlank) next.push(emptyLine());\n      return next;\n    });\n    updateAvailability(idx, ((_lines$idx2 = lines[idx]) === null || _lines$idx2 === void 0 ? void 0 : _lines$idx2.itemName) || \"\", clean);\n  };\n  const handlePrice = (idx, v) => setLines(prev => prev.map((r, i) => i !== idx ? r : {\n    ...r,\n    unitPrice: String(v).replace(/[^0-9.]/g, \"\")\n  }));\n  const handleHSN = (idx, v) => setLines(prev => prev.map((r, i) => i !== idx ? r : {\n    ...r,\n    hsn: v\n  }));\n  const handleGST = (idx, v) => setLines(prev => prev.map((r, i) => i !== idx ? r : {\n    ...r,\n    gst: String(v).replace(/[^0-9.]/g, \"\")\n  }));\n  /* const handleUnit = (idx, v) =>\r\n     setLines((prev) =>\r\n       prev.map((r, i) => (i !== idx ? r : { ...r, unit: v }))\r\n     );*/\n  const addRow = () => setLines(prev => [...prev, emptyLine()]);\n  const removeRow = idx => {\n    setLines(prev => prev.filter((_, i) => i !== idx));\n    setStatuses(s => {\n      const {\n        [idx]: _omit,\n        ...rest\n      } = s;\n      return rest;\n    });\n  };\n\n  // ============ totals (with GST rounding) ============\n  const computed = useMemo(() => {\n    const filled = lines.filter(l => l.itemName && Number(l.qty) > 0);\n    const baseRows = filled.map(l => {\n      const qty = Number(l.qty || 0);\n      const rate = Number(l.unitPrice || 0);\n      const gstRate = Number(l.gst || 0);\n      const lineTaxable = qty * rate;\n      return {\n        ...l,\n        qty,\n        rate,\n        gstRate,\n        lineTaxable\n      };\n    });\n    const taxable = baseRows.reduce((s, r) => s + r.lineTaxable, 0);\n    const pct = Math.max(0, Number(discountPct || 0));\n    const discountAmount = +(taxable * (pct / 100)).toFixed(2);\n    const discountedTaxable = +(taxable - discountAmount).toFixed(2);\n    const factor = taxable > 0 ? 1 - pct / 100 : 1;\n    let cgstRaw = 0,\n      sgstRaw = 0,\n      igstRaw = 0;\n    baseRows.forEach(r => {\n      const discLineTaxable = r.lineTaxable * factor;\n      const lineGST = discLineTaxable * (r.gstRate / 100);\n      if ((buyer.stateCode || \"\").trim() !== ((company === null || company === void 0 ? void 0 : company.stateCode) || \"\").trim()) {\n        igstRaw += lineGST;\n      } else {\n        cgstRaw += lineGST / 2;\n        sgstRaw += lineGST / 2;\n      }\n    });\n    const rawGSTTotal = cgstRaw + sgstRaw + igstRaw;\n    const roundRupee = x => Math.round(x);\n    const isInter = (buyer.stateCode || \"\").trim() !== ((company === null || company === void 0 ? void 0 : company.stateCode) || \"\").trim();\n    const cgstRounded = isInter ? 0 : roundRupee(cgstRaw);\n    const sgstRounded = isInter ? 0 : roundRupee(sgstRaw);\n    const igstRounded = isInter ? roundRupee(igstRaw) : 0;\n    const gstRounded = isInter ? igstRounded : cgstRounded + sgstRounded;\n    const roundOff = +(gstRounded - rawGSTTotal).toFixed(2);\n    const total = +(discountedTaxable + gstRounded).toFixed(2);\n    const grand = total;\n    return {\n      rows: baseRows,\n      taxable,\n      discountAmount,\n      discountedTaxable,\n      rawGSTTotal,\n      cgstRounded,\n      sgstRounded,\n      igstRounded,\n      gstRounded,\n      roundOff,\n      total,\n      grand\n    };\n  }, [lines, discountPct, buyer.stateCode, company === null || company === void 0 ? void 0 : company.stateCode]);\n  const isInterState = useMemo(() => (buyer.stateCode || \"\").trim() !== ((company === null || company === void 0 ? void 0 : company.stateCode) || \"\").trim(), [buyer.stateCode, company === null || company === void 0 ? void 0 : company.stateCode]);\n\n  // Split: paid now & balance\n  const paidNow = useMemo(() => {\n    const s1 = splitEnabled ? n(split1.amount) : 0;\n    const s2 = splitEnabled ? n(split2.amount) : 0;\n    return n(advance) + s1 + s2;\n  }, [advance, splitEnabled, split1.amount, split2.amount]);\n  const balanceAfterSplits = useMemo(() => Math.max(0, +(computed.grand - paidNow).toFixed(2)), [computed.grand, paidNow]);\n\n  // ====== Export Excel (with split details) ======\n  const exportExcel = () => {\n    const consigneeForExcel = consigneeDifferent ? consignee : buyer;\n    const pct = Math.max(0, Number(discountPct || 0));\n    const factor = 1 - pct / 100;\n    const invoiceAdvance = n(advance);\n    const split1Amt = splitEnabled ? n(split1.amount) : 0;\n    const split2Amt = splitEnabled ? n(split2.amount) : 0;\n    const invoicePaidNow = invoiceAdvance + split1Amt + split2Amt;\n    const invoiceBalance = +(computed.grand - invoicePaidNow).toFixed(2);\n    const rows = (computed.rows.length ? computed.rows : []).map((r, idx) => {\n      const lineTaxableDisc = +(r.lineTaxable * factor).toFixed(2);\n      const lineGSTRaw = lineTaxableDisc * (r.gstRate / 100);\n      const cgstP = isInterState ? 0 : r.gstRate / 2;\n      const sgstP = isInterState ? 0 : r.gstRate / 2;\n      const igstP = isInterState ? r.gstRate : 0;\n      const totalVal = lineTaxableDisc + lineGSTRaw;\n      const roundOffForRow = idx === 0 ? computed.roundOff : 0;\n      return {\n        \"VOUCHER TYPE\": \"Sales\",\n        DATE: fmtDDMMYYYY(invMeta.date),\n        \"VOUCHER NUMBER\": invMeta.invoiceNo,\n        \"PARTY NAME\": buyer.name || \"\",\n        GSTIN: buyer.gstin || \"\",\n        ADDRESS: `${buyer.addr1 || \"\"} ${buyer.addr2 || \"\"}`.trim(),\n        STATE: buyer.state || \"\",\n        \"BUYER CITYPIN\": buyer.city || \"\",\n        \"BUYER STATE CODE\": buyer.stateCode || \"\",\n        \"CONSIGNEE NAME\": consigneeForExcel.name || \"\",\n        \"CONSIGNEE ADDRESS\": `${consigneeForExcel.addr1 || \"\"} ${consigneeForExcel.addr2 || \"\"}`.trim(),\n        \"CONSIGNEE CITYPIN\": consigneeForExcel.city || \"\",\n        \"CONSIGNEE STATE\": consigneeForExcel.state || \"\",\n        \"CONSIGNEE STATE CODE\": consigneeForExcel.stateCode || \"\",\n        \"ITEM NAME\": r.itemName || \"\",\n        \"HSN CODE\": r.hsn || \"\",\n        QTY: r.qty || 0,\n        UOM: r.unit || \"KG\",\n        RATE: r.rate || 0,\n        \"TAXABLE VALUE\": +lineTaxableDisc.toFixed(2),\n        \"CGST %\": cgstP,\n        \"SGST %\": sgstP,\n        \"IGST %\": igstP,\n        \"TOTAL VALUE\": +totalVal.toFixed(2),\n        NARRATION: paymentMode ? `Sale of goods â€” Payment: ${paymentMode}` + (splitEnabled ? `; Split1 ${split1Amt} ${split1.mode}${split1.ref ? \" (\" + split1.ref + \")\" : \"\"}; Split2 ${split2Amt} ${split2.mode}${split2.ref ? \" (\" + split2.ref + \")\" : \"\"}` : \"\") : splitEnabled ? `Sale of goods â€” Split1 ${split1Amt} ${split1.mode}${split1.ref ? \" (\" + split1.ref + \")\" : \"\"}; Split2 ${split2Amt} ${split2.mode}${split2.ref ? \" (\" + split2.ref + \")\" : \"\"}` : \"Sale of goods\",\n        \"ROUND OFF\": roundOffForRow,\n        \"PLACE OF SUPPLY\": buyer.state || \"\",\n        \"TERMS OF PAYMENT\": paymentMode || \"\",\n        \"EWAY BILL NO\": invMeta.ewayNo || \"\",\n        \"LR DATE\": invMeta.lrDate || \"\",\n        \"INV TAXABLE TOTAL\": +computed.taxable.toFixed(2),\n        \"INV DISCOUNT %\": pct,\n        \"INV DISCOUNT AMOUNT\": +computed.discountAmount.toFixed(2),\n        \"INV TAXABLE AFTER DISC\": +computed.discountedTaxable.toFixed(2),\n        \"INV GST TOTAL\": +computed.gstRounded.toFixed(2),\n        \"INV ROUND OFF\": +computed.roundOff.toFixed(2),\n        \"INV GRAND TOTAL\": +computed.grand.toFixed(2),\n        \"INV ADVANCE\": invoiceAdvance,\n        \"INV SPLIT1 AMT\": split1Amt,\n        \"INV SPLIT1 MODE\": splitEnabled ? split1.mode : \"\",\n        \"INV SPLIT1 REF\": splitEnabled ? split1.ref : \"\",\n        \"INV SPLIT2 AMT\": split2Amt,\n        \"INV SPLIT2 MODE\": splitEnabled ? split2.mode : \"\",\n        \"INV SPLIT2 REF\": splitEnabled ? split2.ref : \"\",\n        \"INV PAID NOW\": invoicePaidNow,\n        \"INV BALANCE\": invoiceBalance\n      };\n    });\n    const data = rows.length > 0 ? rows : [{\n      \"VOUCHER TYPE\": \"Sales\",\n      DATE: fmtDDMMYYYY(invMeta.date),\n      \"VOUCHER NUMBER\": invMeta.invoiceNo,\n      \"PARTY NAME\": buyer.name || \"\",\n      GSTIN: buyer.gstin || \"\",\n      ADDRESS: `${buyer.addr1 || \"\"} ${buyer.addr2 || \"\"}`.trim(),\n      STATE: buyer.state || \"\",\n      \"BUYER CITYPIN\": buyer.city || \"\",\n      \"BUYER STATE CODE\": buyer.stateCode || \"\",\n      \"CONSIGNEE NAME\": consigneeForExcel.name || \"\",\n      \"CONSIGNEE ADDRESS\": `${consigneeForExcel.addr1 || \"\"} ${consigneeForExcel.addr2 || \"\"}`.trim(),\n      \"CONSIGNEE CITYPIN\": consigneeForExcel.city || \"\",\n      \"CONSIGNEE STATE\": consigneeForExcel.state || \"\",\n      \"CONSIGNEE STATE CODE\": consigneeForExcel.stateCode || \"\",\n      \"ITEM NAME\": \"\",\n      \"HSN CODE\": \"\",\n      QTY: 0,\n      UOM: \"KGS\",\n      RATE: 0,\n      \"TAXABLE VALUE\": 0,\n      \"CGST %\": 0,\n      \"SGST %\": 0,\n      \"IGST %\": 0,\n      \"TOTAL VALUE\": 0,\n      NARRATION: paymentMode ? `Sale of goods â€” Payment: ${paymentMode}` : \"Sale of goods\",\n      \"ROUND OFF\": computed.roundOff || 0,\n      \"PLACE OF SUPPLY\": buyer.state || \"\",\n      \"TERMS OF PAYMENT\": paymentMode || \"\",\n      \"EWAY BILL NO\": invMeta.ewayNo || \"\",\n      \"LR DATE\": invMeta.lrDate || \"\",\n      \"INV TAXABLE TOTAL\": +computed.taxable.toFixed(2),\n      \"INV DISCOUNT %\": pct,\n      \"INV DISCOUNT AMOUNT\": +computed.discountAmount.toFixed(2),\n      \"INV TAXABLE AFTER DISC\": +computed.discountedTaxable.toFixed(2),\n      \"INV GST TOTAL\": +computed.gstRounded.toFixed(2),\n      \"INV ROUND OFF\": +computed.roundOff.toFixed(2),\n      \"INV GRAND TOTAL\": +computed.grand.toFixed(2),\n      \"INV ADVANCE\": invoiceAdvance,\n      \"INV SPLIT1 AMT\": split1Amt,\n      \"INV SPLIT1 MODE\": splitEnabled ? split1.mode : \"\",\n      \"INV SPLIT1 REF\": splitEnabled ? split1.ref : \"\",\n      \"INV SPLIT2 AMT\": split2Amt,\n      \"INV SPLIT2 MODE\": splitEnabled ? split2.mode : \"\",\n      \"INV SPLIT2 REF\": splitEnabled ? split2.ref : \"\",\n      \"INV PAID NOW\": invoicePaidNow,\n      \"INV BALANCE\": invoiceBalance\n    }];\n    const ws = XLSX.utils.json_to_sheet(data, {\n      header: [\"VOUCHER TYPE\", \"DATE\", \"VOUCHER NUMBER\", \"PARTY NAME\", \"GSTIN\", \"ADDRESS\", \"STATE\", \"BUYER CITYPIN\", \"BUYER STATE CODE\", \"CONSIGNEE NAME\", \"CONSIGNEE ADDRESS\", \"CONSIGNEE CITYPIN\", \"CONSIGNEE STATE\", \"CONSIGNEE STATE CODE\", \"ITEM NAME\", \"HSN CODE\", \"QTY\", \"UOM\", \"RATE\", \"TAXABLE VALUE\", \"CGST %\", \"SGST %\", \"IGST %\", \"TOTAL VALUE\", \"NARRATION\", \"ROUND OFF\", \"PLACE OF SUPPLY\", \"TERMS OF PAYMENT\", \"EWAY BILL NO\", \"LR DATE\", \"INV TAXABLE TOTAL\", \"INV DISCOUNT %\", \"INV DISCOUNT AMOUNT\", \"INV TAXABLE AFTER DISC\", \"INV GST TOTAL\", \"INV ROUND OFF\", \"INV GRAND TOTAL\", \"INV ADVANCE\", \"INV SPLIT1 AMT\", \"INV SPLIT1 MODE\", \"INV SPLIT1 REF\", \"INV SPLIT2 AMT\", \"INV SPLIT2 MODE\", \"INV SPLIT2 REF\", \"INV PAID NOW\", \"INV BALANCE\"]\n    });\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, ws, \"Invoice\");\n    const fileName = `Invoice_${invMeta.invoiceNo.replace(/[\\/\\\\:*?\"<>|]/g, \"-\")}.xlsx`;\n    XLSX.writeFile(wb, fileName);\n  };\n\n  // ===================== PRINT (with split payment details) =====================\n  const printNow = () => {\n    var _buyer$pin, _buyer$pin$trim;\n    const missing = [];\n    if (!buyer.name.trim()) missing.push(\"Buyer Name\");\n    if (!buyer.addr1.trim()) missing.push(\"Buyer Address 1\");\n    if (!buyer.city.trim()) missing.push(\"Buyer City\");\n    if (!((_buyer$pin = buyer.pin) !== null && _buyer$pin !== void 0 && (_buyer$pin$trim = _buyer$pin.trim) !== null && _buyer$pin$trim !== void 0 && _buyer$pin$trim.call(_buyer$pin))) missing.push(\"Buyer PIN\");\n    if (missing.length) {\n      alert(\"Please fill mandatory fields:\\n\" + missing.join(\"\\n\"));\n      return;\n    }\n    const issues = [];\n    lines.forEach((l, i) => {\n      if (!l.itemName || !Number(l.qty)) return;\n      const st = statuses[i];\n      if (!(st !== null && st !== void 0 && st.exists)) issues.push(`Row ${i + 1}: Item not found in inventory`);else if (!(st !== null && st !== void 0 && st.can_deliver)) issues.push(`Row ${i + 1}: Only ${st.stock} in stock`);\n    });\n    if (issues.length) {\n      alert(\"Please fix before printing:\\n\" + issues.join(\"\\n\"));\n      return;\n    }\n    const wnd = window.open(\"\", \"_blank\");\n    if (!wnd) return;\n    const useConsignee = consigneeDifferent ? consignee : buyer;\n    const fmtL = d => new Date(d).toLocaleDateString(\"en-IN\", {\n      day: \"2-digit\",\n      month: \"short\",\n      year: \"numeric\"\n    });\n\n    // build invoice rows for print\n    const rowHtmlArr = (computed.rows.length ? computed.rows : []).map((r, i) => {\n      const pct = Math.max(0, Number(discountPct || 0));\n      const factor = 1 - pct / 100;\n      const lineBase = r.lineTaxable;\n      const lineTaxableDisc = +(r.lineTaxable * factor).toFixed(2);\n      const amountWithTaxRaw = lineTaxableDisc + lineTaxableDisc * r.gstRate / 100;\n      const taxLabel = r.gstRate ? isInterState ? `${r.gstRate}% IGST` : `${(r.gstRate / 2).toFixed(0)}% + ${(r.gstRate / 2).toFixed(0)}%` : \"-\";\n      return `\n          <tr>\n            <td class=\"c\">${i + 1}</td>\n            <td>${escapeHtml(r.itemName)}</td>\n            <td class=\"c\">${escapeHtml(r.hsn || \"\")}</td>\n            <td class=\"r\">${r.qty}</td>\n            <td class=\"c\">${escapeHtml(r.unit || \"KGS\")}</td>\n            <td class=\"r\">${toINR(r.rate)}</td>\n            <td class=\"r\">${toINR(lineBase)}</td>\n            <td class=\"c\">${taxLabel}</td>\n            <td class=\"r\">${toINR(amountWithTaxRaw)}</td>\n          </tr>`;\n    });\n\n    // pad rows to fixed count (10)\n    const TARGET_ROWS = 10;\n    const blankCount = Math.max(0, TARGET_ROWS - rowHtmlArr.length);\n    for (let k = 0; k < blankCount; k++) {\n      rowHtmlArr.push(`\n          <tr>\n            <td class=\"c\">&nbsp;</td>\n            <td>&nbsp;</td>\n            <td class=\"c\">&nbsp;</td>\n            <td class=\"r\">&nbsp;</td>\n            <td class=\"c\">&nbsp;</td>\n            <td class=\"r\">&nbsp;</td>\n            <td class=\"r\">&nbsp;</td>\n            <td class=\"c\">&nbsp;</td>\n            <td class=\"r\">&nbsp;</td>\n          </tr>`);\n    }\n    const rowsHtml = rowHtmlArr.join(\"\") || `<tr><td colspan=\"9\" class=\"c muted\">No items</td></tr>`;\n    const cssHref = Array.from(document.styleSheets).map(s => s.href).filter(Boolean).find(h => h.includes(\"BillingPanel.css\")) || \"BillingPanel.css\";\n\n    // totals used in print\n    const adv = paidNow; // advance + split payments\n    const balanceDue = balanceAfterSplits;\n\n    // NEW: split details rows\n    const splitLinesHtml = splitEnabled ? `\n              <tr><td colspan=\"8\" class=\"r\">Split #1 (${escapeHtml(split1.mode || \"-\")})</td><td class=\"r\">${toINR(n(split1.amount))}</td></tr>\n              ${n(split2.amount) > 0 ? `<tr><td colspan=\"8\" class=\"r\">Split #2 (${escapeHtml(split2.mode || \"-\")})</td><td class=\"r\">${toINR(n(split2.amount))}</td></tr>` : \"\"}\n          ` : \"\";\n    const html = `<!doctype html><html><head><meta charset=\"utf-8\" />\n        <title>Tax Invoice</title>\n        <link rel=\"stylesheet\" href=\"${cssHref}\">\n        <style>\n          @page { size: A4; margin: 10mm; }\n          @media print {\n            html, body { width: 210mm; }\n            .shell { border: 0; padding: 0; }\n            table { page-break-inside: auto; }\n            tr { page-break-inside: avoid; break-inside: avoid; }\n            thead { display: table-header-group; }\n            tfoot { display: table-footer-group; }\n          }\n          body{font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial; margin:16px}\n          .small{font-size:12px;color:#555}\n          .muted{color:#6b7280}\n          .r{text-align:right}.c{text-align:center}\n          .shell{border:1px solid #111; padding:12px}\n          .grid{display:grid; grid-template-columns: 1.2fr .9fr; gap:12px}\n          .box{border:1px solid #111; padding:8px}\n          .two{display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-top:8px}\n          .foot{display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:8px}\n          .hr{border-top:1px solid #ddd; margin:6px 0}\n          table{width:100%; border-collapse:collapse; margin-top:8px}\n          th,td{border:1px solid #111; padding:6px; font-size:13px}\n          th{background:#f9fafb; white-space:nowrap}\n          td:nth-child(2){word-break:break-word}\n          tbody tr:nth-child(odd){background:#fcfcfc}\n        </style>\n      </head>\n      <body class=\"invoice-print\">\n        <div class=\"shell\">\n          <div class=\"grid\">\n            <div class=\"box\">\n              <div style=\"display:flex;justify-content:space-between;align-items:center\">\n                <div>\n                  <div style=\"font-size:18px;font-weight:700\">${escapeHtml((company === null || company === void 0 ? void 0 : company.name) || \"\")}</div>\n                  <div class=\"small\">${escapeHtml((company === null || company === void 0 ? void 0 : company.addr1) || \"\")}</div>\n                  <div class=\"small\">${escapeHtml((company === null || company === void 0 ? void 0 : company.addr2) || \"\")}</div>\n                  <div class=\"small\">${escapeHtml((company === null || company === void 0 ? void 0 : company.city) || \"\")}</div>\n                  <div class=\"small\">State: ${escapeHtml((company === null || company === void 0 ? void 0 : company.state) || \"-\")}, Code: ${escapeHtml((company === null || company === void 0 ? void 0 : company.stateCode) || \"-\")}</div>\n                  <div class=\"small\">GSTIN/UIN: ${escapeHtml((company === null || company === void 0 ? void 0 : company.gstin) || \"-\")}</div>\n                  ${company !== null && company !== void 0 && company.email ? `<div class=\"small\">E-Mail : ${escapeHtml(company.email)}</div>` : \"\"}\n                  ${company !== null && company !== void 0 && company.mobile || company !== null && company !== void 0 && company.phone || company !== null && company !== void 0 && company.whatsapp ? `<div class=\"small\">Phone : ${escapeHtml([company.mobile, company.phone].filter(Boolean).join(\" / \"))}${company !== null && company !== void 0 && company.whatsapp ? \" | WhatsApp: \" + escapeHtml(company.whatsapp) : \"\"}</div>` : \"\"}\n                </div>\n                <div style=\"font-size:12px;font-weight:700\">Tax invoice</div>\n              </div>\n\n              <div class=\"two\">\n                <div class=\"box\">\n                  <div style=\"font-weight:600;font-size:12px\">Consignee (Ship To)</div>\n                  <div style=\"font-weight:600\">${escapeHtml(useConsignee.name || \"-\")}</div>\n                  \n                  <div class=\"small\">${escapeHtml(useConsignee.addr1 || \"\")}</div>\n                  <div class=\"small\">${escapeHtml(useConsignee.addr2 || \"\")}</div>\n                  <div class=\"small\">${escapeHtml(useConsignee.city || \"\")}</div>\n                  <div class=\"small\">State: ${escapeHtml(useConsignee.state || \"-\")}, Code: ${escapeHtml(useConsignee.stateCode || \"-\")}</div>\n                  <div class=\"small\">GSTIN/UIN: ${escapeHtml(useConsignee.gstin || \"-\")}</div>\n                </div>\n                <div class=\"box\">\n                  <div style=\"font-weight:600;font-size:12px\">Buyer (Bill To)</div>\n                  <div style=\"font-weight:600\">${escapeHtml(buyer.name || \"-\")}</div>\n                    ${buyer.mobile ? `<div class=\"small\">Mobile: ${escapeHtml(buyer.mobile)}</div>` : \"\"}\n                  \n                  <div class=\"small\">${escapeHtml(buyer.addr1 || \"\")}</div>\n                  <div class=\"small\">${escapeHtml(buyer.addr2 || \"\")}</div>\n                  <div class=\"small\">${escapeHtml(buyer.city || \"\")}</div>\n                  <div class=\"small\">State: ${escapeHtml(buyer.state || \"-\")}, Code: ${escapeHtml(buyer.stateCode || \"-\")}</div>\n                  <div class=\"small\">GSTIN/UIN: ${escapeHtml(buyer.gstin || \"-\")}</div>\n                </div>\n              </div>\n            </div>\n\n            <div class=\"box\">\n              <table>\n                <tbody>\n                  <tr><td style=\"width:45%\">Invoice No</td><td>${escapeHtml(invMeta.invoiceNo)}</td></tr>\n                  <tr><td>Date</td><td>${fmtL(invMeta.date)}</td></tr>\n                  <tr><td>Terms of Payment</td><td>${escapeHtml(paymentMode || \"-\")}</td></tr>\n                  <tr>\n                    <td>Payment Receipt No</td>\n                    <td>${escapeHtml(paymentReceiptNo || \"-\")}</td>\n                  </tr>\n                  <tr><td>e-Way Bill No</td><td>${escapeHtml(invMeta.ewayNo || \"-\")}</td></tr>\n                  <tr><td>LR / Date</td><td>${escapeHtml(invMeta.lrDate || \"-\")}</td></tr>\n                  <tr><td>Vehicle No</td><td>${escapeHtml(invMeta.vehicleNo || \"-\")}</td></tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n\n          <table style=\"margin-top:8px\">\n            <thead>\n              <tr>\n                <th style=\"width:36px\">S.No</th>\n                <th>Description of Goods</th>\n                <th>HSN/SAC</th>\n                <th class=\"r\">Quantity</th>\n                <th>Unit</th>\n                <th class=\"r\">Rate</th>\n                <th class=\"r\">Price</th>\n                <th class=\"c\">GST %</th>\n                <th class=\"r\">Amount</th>\n              </tr>\n            </thead>\n\n            <tbody>\n              ${rowsHtml}\n              <tr><td colspan=\"8\" class=\"r\"><b>Taxable Value</b></td><td class=\"r\"><b>${toINR(computed.taxable)}</b></td></tr>\n              <tr><td colspan=\"8\" class=\"r\">Discount (${Number(discountPct || 0)}%)</td><td class=\"r\">-${toINR(computed.discountAmount)}</td></tr>\n              <tr><td colspan=\"8\" class=\"r\">Taxable After Discount</td><td class=\"r\">${toINR(computed.discountedTaxable)}</td></tr>\n              ${isInterState ? `<tr><td colspan=\"8\" class=\"r\"><b>IGST (rounded)</b></td><td class=\"r\"><b>${toINR(computed.igstRounded)}</b></td></tr>` : `<tr><td colspan=\"8\" class=\"r\">CGST (rounded)</td><td class=\"r\">${toINR(computed.cgstRounded)}</td></tr>\n                    <tr><td colspan=\"8\" class=\"r\">SGST (rounded)</td><td class=\"r\">${toINR(computed.sgstRounded)}</td></tr>`}\n              <tr><td colspan=\"8\" class=\"r\">Round Off (GST rounding)</td><td class=\"r\">${toINR(computed.roundOff)}</td></tr>\n              <tr><td colspan=\"8\" class=\"r\"><b>Total</b></td><td class=\"r\"><b>${toINR(computed.total)}</b></td></tr>\n              <tr><td colspan=\"8\" class=\"r\"><b>Grand Total</b></td><td class=\"r\"><b>${toINR(computed.grand)}</b></td></tr>\n\n              ${splitLinesHtml}\n\n              <tr><td colspan=\"8\" class=\"r\">Advance / Received</td><td class=\"r\">-${toINR(adv)}</td></tr>\n              <tr><td colspan=\"8\" class=\"r\"><b>Balance Due</b></td><td class=\"r\"><b>${toINR(balanceDue)}</b></td></tr>\n            </tbody>\n          </table>\n\n          <div class=\"foot\">\n            <div class=\"box\">\n              <div><b>Amount Chargeable (in words)</b></div>\n              <div class=\"small\" style=\"margin-top:4px\">INR ${numberToWordsIndian(Math.round(computed.grand))} Only</div>\n              <div class=\"hr\"></div>\n              <div class=\"small\"><b>Tax Amount (in words)</b></div>\n              <div class=\"small\">INR ${numberToWordsIndian(Math.round(computed.gstRounded))} Only</div>\n            </div>\n            <div class=\"box\">\n              <div class=\"small\"><b>Company's Bank Details</b></div>\n              ${defaultBank ? `\n                <div class=\"small\">Bank : ${escapeHtml(defaultBank.bankName || \"\")}</div>\n                <div class=\"small\">Branch & IFSC : ${escapeHtml(defaultBank.branch || \"\")} & ${escapeHtml(defaultBank.ifsc || \"\")}</div>\n                <div class=\"small\">A/C No : ${escapeHtml(defaultBank.account || \"\")}</div>` : `<div class=\"small\">No bank selected</div>`}\n              <div class=\"hr\"></div>\n              <div class=\"small c\">For ${escapeHtml((company === null || company === void 0 ? void 0 : company.name) || \"\")}</div>\n              <div style=\"height:48px\"></div>\n              <div class=\"small r\">Authorised Signatory</div>\n            </div>\n          </div>\n\n          <div class=\"small\" style=\"margin-top:8px\">\n            <b>Declaration:</b> We declare that this invoice shows the actual price of the goods described and that all particulars are true and correct.\n            <div>SUBJECT TO TRICHY JURISDICTION</div>\n          </div>\n        </div>\n        <script>window.onload = () => window.print();</script>\n      </body></html>`;\n    wnd.document.write(html);\n    wnd.document.close();\n  };\n\n  // ================= UI =================\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"billing-full card\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-grid-4\",\n          style: {\n            marginTop: 6\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-grid-3\",\n            style: {\n              marginTop: 6\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Invoice Type\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1247,\n                columnNumber: 7\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: invoiceType,\n                onChange: e => setInvoiceType(e.target.value),\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"B2C\",\n                  children: \"B2C\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1252,\n                  columnNumber: 9\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"B2B\",\n                  children: \"B2B\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1253,\n                  columnNumber: 9\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1248,\n                columnNumber: 7\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1246,\n              columnNumber: 5\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1259,\n                columnNumber: 7\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                value: invMeta.date,\n                onChange: e => setInvMeta(m => ({\n                  ...m,\n                  date: e.target.value\n                }))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1260,\n                columnNumber: 7\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1258,\n              columnNumber: 5\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1244,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: \"flex\",\n              gap: \"20px\",\n              alignItems: \"center\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"meta-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"meta-field\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"eWay Bill No\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1275,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: invMeta.ewayNo,\n                  onChange: e => setInvMeta(m => ({\n                    ...m,\n                    ewayNo: e.target.value\n                  }))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1276,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1274,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"meta-field\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Vehicle No\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1284,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: invMeta.vehicleNo,\n                  onChange: e => setInvMeta(m => ({\n                    ...m,\n                    vehicleNo: e.target.value.toUpperCase()\n                  })),\n                  placeholder: \"Vehicle No.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1285,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1283,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"meta-field\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"KMs\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1296,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: invMeta.kms || \"\",\n                  onChange: e => setInvMeta(m => ({\n                    ...m,\n                    kms: e.target.value.replace(/[^0-9]/g, \"\")\n                  }))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1297,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1295,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"meta-field\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"From Date\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1309,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"date\",\n                  value: invMeta.fromDate || \"\",\n                  onChange: e => setInvMeta(m => ({\n                    ...m,\n                    fromDate: e.target.value\n                  }))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1310,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1308,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"meta-field\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"To Date\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1320,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"date\",\n                  value: invMeta.toDate || \"\",\n                  onChange: e => setInvMeta(m => ({\n                    ...m,\n                    toDate: e.target.value\n                  }))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1321,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1319,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1273,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1270,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1243,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1242,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"small\",\n          children: \"Buyer (Bill To)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1348,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-grid-4\",\n          style: {\n            marginTop: 6\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                position: \"relative\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Name *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1352,\n                columnNumber: 5\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: buyer.name,\n                onChange: e => {\n                  const v = e.target.value;\n                  setBuyer(b => ({\n                    ...b,\n                    name: v\n                  }));\n                  setNameQuery(v);\n                },\n                onFocus: () => setNameQuery(buyer.name || \" \"),\n                placeholder: \"Type buyer name...\",\n                autoComplete: \"off\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1353,\n                columnNumber: 5\n              }, this), nameSuggest.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  position: \"absolute\",\n                  top: \"100%\",\n                  left: 0,\n                  right: 0,\n                  background: \"#fff\",\n                  border: \"1px solid #ddd\",\n                  zIndex: 50,\n                  maxHeight: 220,\n                  overflowY: \"auto\",\n                  borderRadius: 8\n                },\n                children: nameSuggest.map((a, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n                  onMouseDown: e => {\n                    e.preventDefault(); // IMPORTANT: prevents blur before click\n                    pickName(a);\n                  },\n                  style: {\n                    padding: \"8px 10px\",\n                    cursor: \"pointer\",\n                    borderBottom: \"1px solid #f1f1f1\"\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontWeight: 600\n                    },\n                    children: a.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1394,\n                    columnNumber: 13\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: 12,\n                      color: \"#666\"\n                    },\n                    children: [a.mobile ? `ðŸ“± ${a.mobile}` : \"\", a.city ? ` â€¢ ${a.city}` : \"\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1395,\n                    columnNumber: 13\n                  }, this)]\n                }, `${a.mobile || \"\"}-${idx}`, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1382,\n                  columnNumber: 11\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1367,\n                columnNumber: 7\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1351,\n              columnNumber: 5\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Mobile No.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1405,\n                columnNumber: 5\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"tel\",\n                list: \"mobile-suggest\",\n                placeholder: \"10-digit mobile\",\n                value: buyer.mobile,\n                onChange: async e => {\n                  const v = String(e.target.value).replace(/[^0-9]/g, \"\").slice(0, 10);\n\n                  // update buyer mobile immediately\n                  setBuyer(b => ({\n                    ...b,\n                    mobile: v\n                  }));\n                  setMobileQuery(v);\n\n                  // reset ledger if user edits mobile again\n                  if (v.length < 10) {\n                    setSelectedAccount(null);\n                    setAccQuery(\"\");\n                    return;\n                  }\n\n                  // when full 10 digits â†’ lookup\n                  if (v.length === 10) {\n                    try {\n                      const acc = await apiAccountByMobile(v);\n                      console.log(\"Lookup by mobile:\", v, acc);\n                      if (acc) {\n                        var _ref14, _acc$name;\n                        const normalized = {\n                          ...acc,\n                          name: (_ref14 = (_acc$name = acc.name) !== null && _acc$name !== void 0 ? _acc$name : acc.account_name) !== null && _ref14 !== void 0 ? _ref14 : \"\"\n                        };\n\n                        // 1ï¸âƒ£ Fill buyer details\n                        fillBuyerFromAccount(normalized);\n\n                        // 2ï¸âƒ£ Auto-assign ledger\n                        setSelectedAccount(normalized);\n                        setAccQuery(normalized.name);\n\n                        // 3ï¸âƒ£ Close all suggestions\n                        setAccSuggest([]);\n                        setMobileSuggest([]);\n                      }\n                    } catch (err) {\n                      console.error(\"Mobile lookup failed\", err);\n                    }\n                  }\n                },\n                onBlur: async () => {\n                  const v = (buyer.mobile || \"\").trim();\n                  if (v.length === 10 && !selectedAccount) {\n                    try {\n                      const acc = await apiAccountByMobile(v);\n                      if (acc) {\n                        var _ref15, _acc$name2;\n                        const normalized = {\n                          ...acc,\n                          name: (_ref15 = (_acc$name2 = acc.name) !== null && _acc$name2 !== void 0 ? _acc$name2 : acc.account_name) !== null && _ref15 !== void 0 ? _ref15 : \"\"\n                        };\n                        fillBuyerFromAccount(normalized);\n                        setSelectedAccount(normalized);\n                        setAccQuery(normalized.name);\n                      }\n                    } catch {}\n                  }\n                  setMobileSuggest([]);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1406,\n                columnNumber: 5\n              }, this), /*#__PURE__*/_jsxDEV(\"datalist\", {\n                id: \"mobile-suggest\",\n                children: mobileSuggest.map((a, idx) => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: a.mobile,\n                  children: a.name ? `${a.name} - ${a.mobile}` : a.mobile\n                }, `${a.mobile}-${idx}`, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1479,\n                  columnNumber: 9\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1477,\n                columnNumber: 5\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1404,\n              columnNumber: 3\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1350,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"GSTIN / UIN\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1490,\n                columnNumber: 7\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: buyer.gstin,\n                onChange: e => setBuyer(b => ({\n                  ...b,\n                  gstin: e.target.value\n                }))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1491,\n                columnNumber: 7\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1489,\n              columnNumber: 5\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                position: \"relative\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Account (Ledger)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1501,\n                columnNumber: 7\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: accQuery,\n                tabIndex: -1,\n                readOnly: !!selectedAccount,\n                onChange: e => {\n                  setAccQuery(e.target.value);\n                  //  setSelectedAccount(null);\n                },\n                onFocus: () => {\n                  if (accQuery.length === 0) setAccSuggest([]);\n                },\n                placeholder: \"Search account\\u2026\",\n                autoComplete: \"off\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1502,\n                columnNumber: 7\n              }, this), accSuggest.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  position: \"absolute\",\n                  top: \"100%\",\n                  left: 0,\n                  right: 0,\n                  background: \"#fff\",\n                  border: \"1px solid #ddd\",\n                  zIndex: 60,\n                  maxHeight: 220,\n                  overflowY: \"auto\",\n                  borderRadius: 8\n                },\n                children: accSuggest.map((a, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n                  onMouseDown: e => {\n                    e.preventDefault(); // prevent blur\n                    pickAccount(a);\n                  },\n                  style: {\n                    padding: \"8px 10px\",\n                    cursor: \"pointer\",\n                    borderBottom: \"1px solid #f1f1f1\"\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontWeight: 600\n                    },\n                    children: a.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1547,\n                    columnNumber: 15\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: 12,\n                      color: \"#666\"\n                    },\n                    children: [\"ID: \", a.account_id, a.mobile ? ` â€¢ ðŸ“± ${a.mobile}` : \"\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1548,\n                    columnNumber: 15\n                  }, this)]\n                }, `${a.account_id}-${idx}`, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1535,\n                  columnNumber: 13\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1520,\n                columnNumber: 9\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1500,\n              columnNumber: 5\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1487,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"State\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1561,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: buyer.state,\n                onChange: e => setBuyer(b => ({\n                  ...b,\n                  state: e.target.value\n                })),\n                placeholder: \"Tamil Nadu\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1562,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1560,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"State Code\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1571,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: buyer.stateCode,\n                onChange: e => setBuyer(b => ({\n                  ...b,\n                  stateCode: String(e.target.value).replace(/[^0-9]/g, \"\")\n                })),\n                placeholder: \"33\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1572,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1570,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1559,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Address 1 *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1586,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              value: buyer.addr1,\n              onChange: e => setBuyer(b => ({\n                ...b,\n                addr1: e.target.value\n              }))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1587,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1585,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Address 2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1595,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              value: buyer.addr2,\n              onChange: e => setBuyer(b => ({\n                ...b,\n                addr2: e.target.value\n              }))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1596,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1594,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"City *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1605,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: buyer.city,\n                onChange: e => setBuyer(b => ({\n                  ...b,\n                  city: e.target.value\n                }))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1606,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1604,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"PIN *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1614,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: buyer.pin,\n                onChange: e => setBuyer(b => ({\n                  ...b,\n                  pin: String(e.target.value).replace(/[^0-9]/g, \"\")\n                }))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1615,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1613,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1603,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1349,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1347,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1240,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"stack\",\n      style: {\n        marginTop: 4\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"small\",\n        style: {\n          display: \"flex\",\n          alignItems: \"center\",\n          gap: 8\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"checkbox\",\n          checked: consigneeDifferent,\n          onChange: e => setConsigneeDifferent(e.target.checked),\n          style: {\n            width: 16,\n            height: 16\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1636,\n          columnNumber: 13\n        }, this), \"Consignee different from Buyer?\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1632,\n        columnNumber: 11\n      }, this), !consigneeDifferent && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"badge\",\n        children: \"Using Buyer as Consignee\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1645,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1631,\n      columnNumber: 9\n    }, this), consigneeDifferent && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        marginTop: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"small\",\n        children: \"Consignee (Ship To)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1652,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-grid-3\",\n        style: {\n          marginTop: 6\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Name\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1656,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: consignee.name,\n            onChange: e => setConsignee(c => ({\n              ...c,\n              name: e.target.value\n            }))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1657,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1655,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"GSTIN/UIN\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1665,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: consignee.gstin,\n            onChange: e => setConsignee(c => ({\n              ...c,\n              gstin: e.target.value\n            }))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1666,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1664,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"State Code\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1674,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: consignee.stateCode,\n            onChange: e => setConsignee(c => ({\n              ...c,\n              stateCode: String(e.target.value).replace(/[^0-9]/g, \"\")\n            })),\n            placeholder: \"33\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1675,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1673,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1654,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-grid-3\",\n        style: {\n          marginTop: 6\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"State\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1690,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: consignee.state,\n            onChange: e => setConsignee(c => ({\n              ...c,\n              state: e.target.value\n            })),\n            placeholder: \"Tamil Nadu\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1691,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1689,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"City\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1700,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: consignee.city,\n            onChange: e => setConsignee(c => ({\n              ...c,\n              city: e.target.value\n            }))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1701,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1699,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"PIN\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1709,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: consignee.pin || \"\",\n            onChange: e => setConsignee(c => ({\n              ...c,\n              pin: String(e.target.value).replace(/[^0-9]/g, \"\")\n            }))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1710,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1708,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1688,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 6\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Address 1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1723,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: consignee.addr1,\n          onChange: e => setConsignee(c => ({\n            ...c,\n            addr1: e.target.value\n          })),\n          style: {\n            width: \"100%\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1724,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1722,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 6\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Address 2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1734,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: consignee.addr2,\n          onChange: e => setConsignee(c => ({\n            ...c,\n            addr2: e.target.value\n          })),\n          style: {\n            width: \"100%\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1735,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1733,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1651,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        marginTop: 12\n      },\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"items-table\",\n        style: {\n          width: \"100%\",\n          tableLayout: \"fixed\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"colgroup\", {\n          children: [/*#__PURE__*/_jsxDEV(\"col\", {\n            style: {\n              width: 44\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1753,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1754,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            style: {\n              width: 100\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1755,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            style: {\n              width: 84\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1756,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            style: {\n              width: 72\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1757,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            style: {\n              width: 96\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1758,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            style: {\n              width: 108\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1759,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            style: {\n              width: 84\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1760,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            style: {\n              width: 116\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1761,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"col\", {\n            style: {\n              width: 56\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1762,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1752,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"#\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1767,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Description of Goods\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1768,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"HSN\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1769,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"right\",\n              children: \"Qty\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1770,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"center\",\n              children: \"Unit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1771,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"right\",\n              children: \"Rate\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1772,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"right\",\n              children: \"Price\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1773,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"right\",\n              children: \"GST %\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1774,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"right\",\n              children: \"Amount\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1775,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"center\",\n              children: \"\\u2716\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1776,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1766,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1765,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: lines.map((l, i) => {\n            const qty = Number(l.qty || 0);\n            const rate = Number(l.unitPrice || 0);\n            const gstPct = Number(l.gst || 0);\n            const price = qty * rate;\n            const st = statuses[i];\n            const disableRowInputs = !!st && (!st.exists || typeof st.stock === \"number\" && st.stock <= 0);\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: i + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1795,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  list: \"bill-suggest\",\n                  placeholder: \"Type to search Purchases\\u2026\",\n                  value: l.itemName,\n                  onChange: e => handleItemChange(i, e.target.value),\n                  onFocus: e => setActiveQuery(e.target.value || \" \")\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1797,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"datalist\", {\n                  id: \"bill-suggest\",\n                  children: suggest.map((s, idx) => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: s.name\n                  }, `${s.name}-${idx}`, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1808,\n                    columnNumber: 27\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1806,\n                  columnNumber: 23\n                }, this), l.itemName && st && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"small\",\n                  style: {\n                    color: st.exists && Number(l.qty || 0) <= st.stock ? \"#047857\" : \"#b91c1c\"\n                  },\n                  children: [!st.exists && \"Not available in Inventory\", st.exists && st.stock === 0 && \"Out of stock\", st.exists && st.stock > 0 && Number(l.qty || 0) === 0 && `In stock: ${st.stock}`, st.exists && Number(l.qty || 0) > st.stock && `Only ${st.stock} in stock`, st.exists && Number(l.qty || 0) > 0 && Number(l.qty || 0) <= st.stock && `Available: ${st.stock}`]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1815,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1796,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: l.hsn,\n                  onChange: e => handleHSN(i, e.target.value),\n                  disabled: disableRowInputs\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1845,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1844,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"right\",\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: l.qty,\n                  onChange: e => handleQty(i, e.target.value),\n                  onBlur: e => updateAvailability(i, l.itemName, e.target.value),\n                  disabled: disableRowInputs\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1853,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1852,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"center\",\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: \"KG\",\n                  readOnly: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1868,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1867,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"right\",\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: l.unitPrice,\n                  onChange: e => handlePrice(i, e.target.value),\n                  disabled: disableRowInputs\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1872,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1871,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"right\",\n                children: toINR(price)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1879,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"right\",\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  value: l.gst,\n                  onChange: e => handleGST(i, e.target.value),\n                  disabled: disableRowInputs\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1882,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1881,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"right\",\n                children: toINR(price + price * gstPct / 100)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1889,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"center\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn warn\",\n                  onClick: () => removeRow(i),\n                  children: \"Del\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1894,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1893,\n                columnNumber: 21\n              }, this)]\n            }, i, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1794,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1780,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tfoot\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: 10,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stack\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn\",\n                  onClick: addRow,\n                  children: \"+ Add Item\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1910,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"muted\",\n                  children: [\"Type to search from \", /*#__PURE__*/_jsxDEV(\"b\", {\n                    children: \"Purchases\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1914,\n                    columnNumber: 43\n                  }, this), \". Unit is fixed to \", /*#__PURE__*/_jsxDEV(\"b\", {\n                    children: \"KG\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1915,\n                    columnNumber: 26\n                  }, this), \"; Rate & GST% auto-fill from the latest Purchase; HSN from Inventory.\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1913,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1909,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1908,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1907,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1906,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1748,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1747,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"totals-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1927,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card\",\n        style: {\n          padding: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          style: {\n            gridTemplateColumns: \"1fr 1fr\",\n            margin: 0\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small\",\n            children: \"Taxable Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1933,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"right\",\n            children: /*#__PURE__*/_jsxDEV(\"b\", {\n              children: toINR(computed.taxable)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1935,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1934,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small\",\n            style: {\n              display: \"flex\",\n              alignItems: \"center\",\n              gap: 8\n            },\n            children: \"Discount (%)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1938,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"right\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              value: discountPct,\n              onChange: e => setDiscountPct(String(e.target.value).replace(/[^0-9.]/g, \"\")),\n              style: {\n                width: 120,\n                textAlign: \"right\"\n              },\n              placeholder: \"0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1945,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1944,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small\",\n            children: \"Discount Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1957,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"right\",\n            children: [\"-\", toINR(computed.discountAmount)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1958,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small\",\n            children: isInterState ? \"GST (IGST)\" : \"GST (CGST+SGST)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1962,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"right\",\n            children: /*#__PURE__*/_jsxDEV(\"b\", {\n              children: isInterState ? toINR(computed.igstRounded) : toINR(computed.cgstRounded + computed.sgstRounded)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1966,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1965,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small\",\n            children: \"Round Off (GST rounding)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1975,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"right\",\n            children: toINR(computed.roundOff)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1976,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small\",\n            children: \"Total\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1980,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"right\",\n            children: /*#__PURE__*/_jsxDEV(\"b\", {\n              children: toINR(computed.total)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1982,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1981,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small\",\n            style: {\n              marginTop: 6\n            },\n            children: /*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Grand Total\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1986,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1985,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"right\",\n            style: {\n              marginTop: 6\n            },\n            children: /*#__PURE__*/_jsxDEV(\"b\", {\n              children: toINR(computed.grand)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1989,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1988,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small\",\n            children: \"Terms of Payment\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2011,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"right\",\n            children: /*#__PURE__*/_jsxDEV(\"select\", {\n              value: paymentMode,\n              onChange: e => setPaymentMode(e.target.value),\n              style: {\n                width: 140,\n                textAlign: \"right\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"Select\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2018,\n                columnNumber: 19\n              }, this), paymentModes.map(m => /*#__PURE__*/_jsxDEV(\"option\", {\n                children: m\n              }, \"pm-\" + m, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2020,\n                columnNumber: 21\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2013,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2012,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small\",\n            children: \"Payment Receipt No.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2024,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"right\",\n            children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: paymentReceiptNo,\n              onChange: e => setPaymentReceiptNo(e.target.value),\n              placeholder: \"Enter receipt / UTR / cheque / reference number\",\n              rows: 2,\n              style: {\n                width: \"100%\",\n                resize: \"vertical\",\n                textAlign: \"left\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2026,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2025,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1929,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2042,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          style: {\n            gridTemplateColumns: \"1fr 1fr\",\n            marginTop: 6\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small\",\n            style: {\n              display: \"flex\",\n              alignItems: \"center\",\n              gap: 8\n            },\n            children: \"Split Payment (max 2)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2047,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"right\",\n            children: /*#__PURE__*/_jsxDEV(\"label\", {\n              style: {\n                display: \"inline-flex\",\n                gap: 8,\n                alignItems: \"center\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"checkbox\",\n                checked: splitEnabled,\n                onChange: e => setSplitEnabled(e.target.checked)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2061,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"small\",\n                children: \"Enable\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2066,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2054,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2053,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2043,\n          columnNumber: 13\n        }, this), splitEnabled && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-3\",\n            style: {\n              display: \"grid\",\n              gridTemplateColumns: \"1fr 1fr 1fr\",\n              gap: 8,\n              marginTop: 8\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Split #1 Amount\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2083,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                step: \"0.01\",\n                value: split1.amount,\n                onChange: e => {\n                  const raw = String(e.target.value);\n                  const clean = raw.replace(/[^0-9.]/g, \"\");\n                  const amt1 = n(clean);\n                  const remaining = Math.max(0, +(computed.grand - amt1).toFixed(2));\n                  setSplit1({\n                    ...split1,\n                    amount: clean\n                  });\n                  setSplit2(prev => ({\n                    ...prev,\n                    amount: remaining > 0 ? String(remaining) : remaining === 0 ? \"0\" : prev.amount\n                  }));\n                },\n                placeholder: \"0\",\n                className: \"right\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2084,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2082,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Split #1 Terms / Mode\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2112,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: split1.mode,\n                onChange: e => setSplit1({\n                  ...split1,\n                  mode: e.target.value\n                }),\n                children: paymentModes.map(m => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: m,\n                  children: m\n                }, \"m1\" + m, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2120,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2113,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2111,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Ref / Txn No. (opt)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2127,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: split1.ref,\n                onChange: e => setSplit1({\n                  ...split1,\n                  ref: e.target.value\n                }),\n                placeholder: \"UTR / Cheque / Last 4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2128,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2126,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2073,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-3\",\n            style: {\n              display: \"grid\",\n              gridTemplateColumns: \"1fr 1fr 1fr\",\n              gap: 8,\n              marginTop: 8\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Split #2 Amount\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2148,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                step: \"0.01\",\n                value: split2.amount,\n                onChange: e => setSplit2({\n                  ...split2,\n                  amount: e.target.value\n                }),\n                placeholder: \"0\",\n                className: \"right\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2149,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2147,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Split #2 Terms / Mode\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2161,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: split2.mode,\n                onChange: e => setSplit2({\n                  ...split2,\n                  mode: e.target.value\n                }),\n                children: paymentModes.map(m => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: m,\n                  children: m\n                }, \"m2\" + m, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2169,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2162,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2160,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Ref / Txn No. (opt)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2176,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: split2.ref,\n                onChange: e => setSplit2({\n                  ...split2,\n                  ref: e.target.value\n                }),\n                placeholder: \"UTR / Cheque / Last 4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2177,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2175,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2138,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            style: {\n              gridTemplateColumns: \"1fr 1fr\",\n              marginTop: 8\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"small\",\n              children: \"Paid Now (Advance + Splits)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2194,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"right\",\n              children: toINR(paidNow)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2197,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2187,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1928,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1926,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"actions-row\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: async () => {\n          var _buyer$pin2, _buyer$pin2$trim;\n          const missing = [];\n          if (!buyer.name.trim()) missing.push(\"Buyer Name\");\n          if (!buyer.addr1.trim()) missing.push(\"Buyer Address 1\");\n          if (!buyer.city.trim()) missing.push(\"Buyer City\");\n          if (!((_buyer$pin2 = buyer.pin) !== null && _buyer$pin2 !== void 0 && (_buyer$pin2$trim = _buyer$pin2.trim) !== null && _buyer$pin2$trim !== void 0 && _buyer$pin2$trim.call(_buyer$pin2))) missing.push(\"Buyer PIN\");\n          console.log(\"Selected Account:\", selectedAccount);\n          if (!(selectedAccount !== null && selectedAccount !== void 0 && selectedAccount.account_id)) {\n            alert(\"Please select Account (Ledger) before saving.\");\n            return;\n          }\n          if (missing.length) {\n            alert(\"Please fill mandatory fields:\\n\" + missing.join(\"\\n\"));\n            return;\n          }\n          const issues = [];\n          lines.forEach((l, i) => {\n            if (!l.itemName || !Number(l.qty)) return;\n            const st = statuses[i];\n            if (!(st !== null && st !== void 0 && st.exists)) issues.push(`Row ${i + 1}: Item not found in inventory`);else if (!(st !== null && st !== void 0 && st.can_deliver)) issues.push(`Row ${i + 1}: Only ${st.stock} in stock`);\n          });\n          if (issues.length) {\n            alert(\"Please fix before saving:\\n\" + issues.join(\"\\n\"));\n            return;\n          }\n          if (!computed.rows.length) {\n            alert(\"No valid line items to save.\");\n            return;\n          }\n          const salePayload = {\n            bill_no: invMeta.invoiceNo,\n            date: invMeta.date,\n            account_id: selectedAccount.account_id,\n            party_name: buyer.name || \"\",\n            invoice_type: invoiceType,\n            // ðŸšš TRANSPORT / E-WAY DETAILS (ADD THIS)\n            eway_no: invMeta.ewayNo || \"\",\n            vehicle_no: invMeta.vehicleNo || \"\",\n            kms: invMeta.kms ? Number(invMeta.kms) : null,\n            from_date: invMeta.fromDate || null,\n            to_date: invMeta.toDate || null,\n            // totals\n            taxable: +computed.taxable.toFixed(2),\n            discount_amount: +computed.discountAmount.toFixed(2),\n            discounted_taxable: +computed.discountedTaxable.toFixed(2),\n            gst_amount: +computed.gstRounded.toFixed(2),\n            round_off: +computed.roundOff.toFixed(2),\n            grand_total: +computed.grand.toFixed(2),\n            paid_now: +paidNow.toFixed(2),\n            balance: +balanceAfterSplits.toFixed(2),\n            payment_mode: paymentMode || \"\",\n            payment_receipt_no: paymentReceiptNo || \"\",\n            // items\n            items: computed.rows.map(r => ({\n              item_name: r.itemName,\n              hsn: r.hsn || \"\",\n              qty: Number(r.qty || 0),\n              unit: r.unit || \"KG\",\n              price: Number(r.rate || 0),\n              gst: Number(r.gstRate || r.gst || 0)\n            }))\n          };\n          try {\n            const resp = await apiCreateSaleFIFO(salePayload);\n            // Optional: you can log / show resp.sale_id, resp.total_amount, etc.\n            console.log(\"Sale created (FIFO):\", resp);\n          } catch (e) {\n            console.error(\"Error creating sale via FIFO:\", e);\n            alert(\"Failed to create sale in database (FIFO).\\n\" + ((e === null || e === void 0 ? void 0 : e.message) || e));\n            return;\n          }\n\n          // 2) Local storage copy (for your own dashboard/history)\n          const bill = {\n            id: Date.now(),\n            account_id: selectedAccount.account_id,\n            account_name: selectedAccount.name,\n            account_mobile: selectedAccount.mobile || buyer.mobile || \"\",\n            company,\n            buyer,\n            consignee: consigneeDifferent ? consignee : buyer,\n            invMeta,\n            lines,\n            computed,\n            discountPct,\n            advance,\n            paymentMode,\n            payments: {\n              splitEnabled,\n              split1: splitEnabled ? {\n                amount: n(split1.amount),\n                mode: split1.mode,\n                ref: split1.ref\n              } : null,\n              split2: splitEnabled ? {\n                amount: n(split2.amount),\n                mode: split2.mode,\n                ref: split2.ref\n              } : null,\n              paidNow,\n              balance: balanceAfterSplits\n            },\n            createdAt: new Date().toISOString()\n          };\n          const arr = JSON.parse(localStorage.getItem(\"bills.v2\") || \"[]\");\n          arr.push(bill);\n          localStorage.setItem(\"bills.v2\", JSON.stringify(arr));\n\n          // 3) Export + Print\n          exportExcel();\n          printNow();\n        },\n        children: \"Save\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2206,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn primary\",\n        onClick: printNow,\n        children: \"Print\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2355,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2205,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1239,\n    columnNumber: 7\n  }, this);\n}\n_s(BillingPanel, \"UT79PBsP/+WUDaKXIMyMi5+vT7M=\");\n_c = BillingPanel;\nvar _c;\n$RefreshReg$(_c, \"BillingPanel\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","XLSX","apiBillingSuggest","apiCheckAvailability","apiPurchasesLast","apiCreateSaleFIFO","apiAccountsSuggest","apiAccountByMobile","apiAccountsSuggestName","apiAccountById","jsxDEV","_jsxDEV","Fragment","_Fragment","emptyLine","itemName","qty","unitPrice","hsn","gst","unit","fmtDDMMYYYY","iso","d","Date","dd","String","getDate","padStart","mm","getMonth","yy","getFullYear","toINR","n","v","isNaN","toLocaleString","minimumFractionDigits","maximumFractionDigits","numberToWordsIndian","num","a","b","inWords","Math","floor","parts","units","label","value","q","push","join","escapeHtml","s","replaceAll","normCode","trim","Number","BillingPanel","company","defaultBank","inventory","_s","paymentReceiptNo","setPaymentReceiptNo","buyer","setBuyer","account_id","name","mobile","addr1","addr2","city","pin","state","stateCode","gstin","email","phone","selectedAccount","setSelectedAccount","invoiceType","setInvoiceType","accQuery","setAccQuery","accSuggest","setAccSuggest","accDebRef","normalizeAccount","_ref","_a$account_id","_ref2","_a$name","id","account_name","clearTimeout","current","setTimeout","length","rows","map","advance","setAdvance","paymentMode","setPaymentMode","paymentModes","splitEnabled","setSplitEnabled","split1","setSplit1","amount","mode","ref","split2","setSplit2","consigneeDifferent","setConsigneeDifferent","consignee","setConsignee","todayIso","toISOString","slice","invMeta","setInvMeta","invoiceNo","date","ewayNo","vehicleNo","kms","fromDate","toDate","lrDate","lines","setLines","discountPct","setDiscountPct","suggest","setSuggest","activeQuery","setActiveQuery","debRef","list","mobileSuggest","setMobileSuggest","mobileQuery","setMobileQuery","mobDebRef","nameSuggest","setNameSuggest","nameQuery","setNameQuery","nameDebRef","pickName","acc","_ref3","_full$account_id","_ref4","_full$name","full","_acc$account_id","normalized","fillBuyerFromAccount","e","console","error","pickAccount","log","_ref5","_full$name2","_ref6","_acc$account_id2","_ref7","_acc$account_name","_acc$mobile","_acc$mobile2","_acc$addr","_acc$addr2","_acc$city","_ref8","_acc$pin","_acc$state","_ref9","_acc$stateCode","_acc$gstin","_acc$email","_acc$phone","replace","statuses","setStatuses","updateAvailability","idx","vname","undefined","st","isFinite","lookupFromInventory","val","arr","Array","isArray","byLower","toLowerCase","found","find","i","_ref0","_ref1","_found$hsn","_ref10","_found$gst","_ref11","_found$unit","_ref12","_found$price","price","f2","_ref13","_f2$HSN","_f2$GST","_f2$UNIT","_f2$PRICE","handleItemChange","_lines$idx","picked","item","stockQty","prev","next","r","_picked$hsn","_picked","_picked$price","_picked2","_picked$gst","_picked3","isNonEmpty","hasBlank","qtyNow","handleQty","_lines$idx2","clean","handlePrice","handleHSN","handleGST","addRow","removeRow","filter","_","_omit","rest","computed","filled","l","baseRows","rate","gstRate","lineTaxable","taxable","reduce","pct","max","discountAmount","toFixed","discountedTaxable","factor","cgstRaw","sgstRaw","igstRaw","forEach","discLineTaxable","lineGST","rawGSTTotal","roundRupee","x","round","isInter","cgstRounded","sgstRounded","igstRounded","gstRounded","roundOff","total","grand","isInterState","paidNow","s1","s2","balanceAfterSplits","exportExcel","consigneeForExcel","invoiceAdvance","split1Amt","split2Amt","invoicePaidNow","invoiceBalance","lineTaxableDisc","lineGSTRaw","cgstP","sgstP","igstP","totalVal","roundOffForRow","DATE","GSTIN","ADDRESS","STATE","QTY","UOM","RATE","NARRATION","data","ws","utils","json_to_sheet","header","wb","book_new","book_append_sheet","fileName","writeFile","printNow","_buyer$pin","_buyer$pin$trim","missing","call","alert","issues","exists","can_deliver","stock","wnd","window","open","useConsignee","fmtL","toLocaleDateString","day","month","year","rowHtmlArr","lineBase","amountWithTaxRaw","taxLabel","TARGET_ROWS","blankCount","k","rowsHtml","cssHref","from","document","styleSheets","href","Boolean","h","includes","adv","balanceDue","splitLinesHtml","html","whatsapp","bankName","branch","ifsc","account","write","close","className","children","style","marginTop","_jsxFileName","lineNumber","columnNumber","onChange","target","type","m","display","gap","alignItems","toUpperCase","placeholder","position","onFocus","autoComplete","top","left","right","background","border","zIndex","maxHeight","overflowY","borderRadius","onMouseDown","preventDefault","padding","cursor","borderBottom","fontWeight","fontSize","color","_ref14","_acc$name","err","onBlur","_ref15","_acc$name2","tabIndex","readOnly","checked","width","height","c","tableLayout","gstPct","disableRowInputs","disabled","onClick","colSpan","gridTemplateColumns","margin","textAlign","resize","step","raw","amt1","remaining","_buyer$pin2","_buyer$pin2$trim","salePayload","bill_no","party_name","invoice_type","eway_no","vehicle_no","from_date","to_date","discount_amount","discounted_taxable","gst_amount","round_off","grand_total","paid_now","balance","payment_mode","payment_receipt_no","items","item_name","resp","message","bill","now","account_mobile","payments","createdAt","JSON","parse","localStorage","getItem","setItem","stringify","_c","$RefreshReg$"],"sources":["C:/CA/pks/src/BillingPanel.jsx"],"sourcesContent":["  // src/BillingPanel.jsx\r\n  import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\n  import * as XLSX from \"xlsx\";\r\n  import \"./BillingPanel.css\";\r\n\r\n  import {\r\n    apiBillingSuggest,\r\n    apiCheckAvailability,\r\n    apiPurchasesLast,\r\n    apiCreateSaleFIFO,\r\n    apiAccountsSuggest,\r\n    apiAccountByMobile,\r\n    apiAccountsSuggestName,\r\n    apiAccountById,\r\n  } from \"./api\";\r\n\r\n\r\n  // ---- helpers (scoped to panel) ----\r\n  const emptyLine = () => ({\r\n    itemName: \"\",\r\n    qty: \"\",\r\n    unitPrice: \"\",\r\n    hsn: \"\",\r\n    gst: \"\",\r\n    unit: \"KG\",\r\n  });\r\n\r\n  const fmtDDMMYYYY = (iso) => {\r\n    const d = new Date(iso);\r\n    const dd = String(d.getDate()).padStart(2, \"0\");\r\n    const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n    const yy = d.getFullYear();\r\n    return `${dd}-${mm}-${yy}`;\r\n  };\r\n\r\n  function toINR(n) {\r\n    const v = isNaN(n) ? 0 : n;\r\n    return v.toLocaleString(\"en-IN\", {\r\n      minimumFractionDigits: 2,\r\n      maximumFractionDigits: 2,\r\n    });\r\n  }\r\n\r\n  function numberToWordsIndian(num) {\r\n    const a = [\r\n      \"\",\r\n      \"One\",\r\n      \"Two\",\r\n      \"Three\",\r\n      \"Four\",\r\n      \"Five\",\r\n      \"Six\",\r\n      \"Seven\",\r\n      \"Eight\",\r\n      \"Nine\",\r\n      \"Ten\",\r\n      \"Eleven\",\r\n      \"Twelve\",\r\n      \"Thirteen\",\r\n      \"Fourteen\",\r\n      \"Fifteen\",\r\n      \"Sixteen\",\r\n      \"Seventeen\",\r\n      \"Eighteen\",\r\n      \"Nineteen\",\r\n    ];\r\n    const b = [\r\n      \"\",\r\n      \"\",\r\n      \"Twenty\",\r\n      \"Thirty\",\r\n      \"Forty\",\r\n      \"Fifty\",\r\n      \"Sixty\",\r\n      \"Seventy\",\r\n      \"Eighty\",\r\n      \"Ninety\",\r\n    ];\r\n    function inWords(n) {\r\n      if (n < 20) return a[n];\r\n      if (n < 100)\r\n        return b[Math.floor(n / 10)] + (n % 10 ? \" \" + a[n % 10] : \"\");\r\n      if (n < 1000)\r\n        return (\r\n          a[Math.floor(n / 100)] +\r\n          \" Hundred\" +\r\n          (n % 100 ? \" and \" + inWords(n % 100) : \"\")\r\n        );\r\n      return \"\";\r\n    }\r\n    if (num === 0) return \"Zero\";\r\n    const parts = [];\r\n    const units = [\r\n      [\"Crore\", 10000000],\r\n      [\"Lakh\", 100000],\r\n      [\"Thousand\", 1000],\r\n      [\"\", 1],\r\n    ];\r\n    let n = Math.floor(num);\r\n    for (const [label, value] of units) {\r\n      const q = Math.floor(n / value);\r\n      if (q) {\r\n        if (value >= 1000) {\r\n          if (q < 100) parts.push(inWords(q) + \" \" + label);\r\n          else parts.push(numberToWordsIndian(q) + \" \" + label);\r\n        } else {\r\n          parts.push(inWords(q));\r\n        }\r\n        n = n % value;\r\n      }\r\n    }\r\n    return parts.join(\" \");\r\n  }\r\n\r\n  function escapeHtml(s) {\r\n    return String(s || \"\")\r\n      .replaceAll(\"&\", \"&amp;\")\r\n      .replaceAll(\"<\", \"&lt;\")\r\n      .replaceAll(\">\", \"&gt;\")\r\n      .replaceAll('\"', \"&quot;\")\r\n      .replaceAll(\"'\", \"&#039;\");\r\n  }\r\n\r\n  const normCode = (v) => String(v || \"\").trim();\r\n\r\n\r\n  // small numeric helper\r\n  const n = (v) => (isNaN(Number(v)) || !v ? 0 : Number(v));\r\n  // Mobile-based typeahead (accounts_list)\r\n\r\n\r\n  /** Billing panel */\r\n  export default function BillingPanel({ company, defaultBank, inventory }) {\r\n    // Buyer / consignee / meta\r\n  // Payment receipt reference\r\n  // ADDED PAYMENT RECEIPT NO\r\n  const [paymentReceiptNo, setPaymentReceiptNo] = useState(\"\");\r\n\r\n\r\n    const [buyer, setBuyer] = useState({\r\n        account_id: null,\r\n      name: \"\",\r\n      mobile: \"\",  \r\n      addr1: \"\",\r\n      addr2: \"\",\r\n      city: \"\",\r\n      pin: \"\",\r\n      state: \"\",\r\n      stateCode: \"\",\r\n      gstin: \"\",\r\n      email: \"\",\r\n      phone: \"\",\r\n    });\r\n\r\n    // Selected account (ledger)\r\n  const [selectedAccount, setSelectedAccount] = useState(null);\r\n  const [invoiceType, setInvoiceType] = useState(\"B2C\"); // default\r\n\r\n  // Account search\r\n  const [accQuery, setAccQuery] = useState(\"\");\r\n  const [accSuggest, setAccSuggest] = useState([]);\r\n  const accDebRef = useRef();\r\n  const normalizeAccount = (a) => ({\r\n    ...a,\r\n    account_id: a.account_id ?? a.id ?? null, \r\n    name: a.name ?? a.account_name ?? \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    // ðŸš« HARD STOP: ledger already selected\r\n    if (selectedAccount) {\r\n      setAccSuggest([]);\r\n      return;\r\n    }\r\n\r\n    clearTimeout(accDebRef.current);\r\n    accDebRef.current = setTimeout(async () => {\r\n      const q = (accQuery || \"\").trim();\r\n      if (q.length < 2) {\r\n        setAccSuggest([]);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const rows = await apiAccountsSuggestName(q, 10);\r\n        setAccSuggest((rows || []).map(normalizeAccount));\r\n      } catch {\r\n        setAccSuggest([]);\r\n      }\r\n    }, 180);\r\n\r\n    return () => clearTimeout(accDebRef.current);\r\n  }, [accQuery, selectedAccount]);\r\n\r\n\r\n  /*\r\n\r\n  useEffect(() => {\r\n    clearTimeout(accDebRef.current);\r\n    accDebRef.current = setTimeout(async () => {\r\n      const q = (accQuery || \"\").trim();\r\n      if (q.length < 2) return setAccSuggest([]);\r\n      try {\r\n        const rows = await apiAccountsSuggestName(q, 10);\r\n        setAccSuggest((rows || []).map(normalizeAccount));\r\n      } catch {\r\n        setAccSuggest([]);\r\n      }\r\n    }, 180);\r\n\r\n    return () => clearTimeout(accDebRef.current);\r\n  }, [accQuery]);\r\n\r\n  */\r\n    // Payments\r\n    const [advance, setAdvance] = useState(\"0\"); // kept in state, but field hidden now\r\n    const [paymentMode, setPaymentMode] = useState(\"\");\r\n    const paymentModes = [\r\n      \"Select\",\r\n      \"Cash\",\r\n      \"UPI\",\r\n      \"Card\",\r\n      \"Bank Transfer\",\r\n      \"Cheque\",\r\n      \"Credit\",\r\n      \"Online\",\r\n    ];\r\n\r\n    // Split payments\r\n    const [splitEnabled, setSplitEnabled] = useState(false);\r\n    const [split1, setSplit1] = useState({ amount: \"\", mode: \"Select\", ref: \"\" });\r\n    const [split2, setSplit2] = useState({ amount: \"\", mode: \"Select\", ref: \"\" });\r\n\r\n    const [consigneeDifferent, setConsigneeDifferent] = useState(false);\r\n    const [consignee, setConsignee] = useState({ ...buyer });\r\n    useEffect(() => {\r\n      if (!consigneeDifferent) setConsignee({ ...buyer });\r\n    }, [consigneeDifferent, buyer]);\r\n\r\n    const todayIso = new Date().toISOString().slice(0, 10);\r\n    const [invMeta, setInvMeta] = useState({\r\n      invoiceNo: \"PKS-B-00001\",\r\n      date: todayIso,\r\n      ewayNo: \"\",\r\n      vehicleNo: \"\",\r\n      kms: \"\",\r\n      fromDate: \"\",\r\n      toDate: \"\",\r\n      lrDate: todayIso,\r\n  });\r\n\r\n\r\n    // lines + discount\r\n    const [lines, setLines] = useState([emptyLine()]);\r\n    const [discountPct, setDiscountPct] = useState(\"0\");\r\n\r\n    // Purchases-based type-ahead\r\n    const [suggest, setSuggest] = useState([]); // [{name}]\r\n    const [activeQuery, setActiveQuery] = useState(\"\");\r\n    const debRef = useRef();\r\n\r\n    useEffect(() => {\r\n      clearTimeout(debRef.current);\r\n      debRef.current = setTimeout(async () => {\r\n        const q = (activeQuery || \"\").trim();\r\n        if (!q) return setSuggest([]);\r\n        try {\r\n          const list = await apiBillingSuggest(q, 25);\r\n          setSuggest(list || []);\r\n        } catch {\r\n          setSuggest([]);\r\n        }\r\n      }, 180);\r\n      return () => clearTimeout(debRef.current);\r\n    }, [activeQuery]);\r\n\r\n    const [mobileSuggest, setMobileSuggest] = useState([]); // rows from backend\r\n  const [mobileQuery, setMobileQuery] = useState(\"\");\r\n  const mobDebRef = useRef();\r\n\r\n    useEffect(() => {\r\n    clearTimeout(mobDebRef.current);\r\n    mobDebRef.current = setTimeout(async () => {\r\n      const q = (mobileQuery || \"\").trim();\r\n      if (q.length < 2) return setMobileSuggest([]);\r\n      try {\r\n        const rows = await apiAccountsSuggest(q, 10);\r\n        setMobileSuggest((rows || []).map(normalizeAccount));\r\n      } catch {\r\n        setMobileSuggest([]);\r\n      }\r\n    }, 180);\r\n\r\n    return () => clearTimeout(mobDebRef.current);\r\n  }, [mobileQuery]);\r\n\r\n  const [nameSuggest, setNameSuggest] = useState([]);\r\n  const [nameQuery, setNameQuery] = useState(\"\");\r\n  const nameDebRef = useRef();\r\n\r\n  useEffect(() => {\r\n    clearTimeout(nameDebRef.current);\r\n    nameDebRef.current = setTimeout(async () => {\r\n      const q = (nameQuery || \"\").trim();\r\n      if (q.length < 2) return setNameSuggest([]);\r\n      try {\r\n        const rows = await apiAccountsSuggestName(q, 10);\r\n        setNameSuggest((rows || []).map(normalizeAccount));\r\n      } catch {\r\n        setNameSuggest([]);\r\n      }\r\n    }, 180);\r\n\r\n    return () => clearTimeout(nameDebRef.current);\r\n  }, [nameQuery]);\r\n\r\n  useEffect(() => {\r\n    if (invoiceType === \"B2C\") {\r\n      setBuyer((b) => ({ ...b, gstin: \"\" }));\r\n    }\r\n  }, [invoiceType]);\r\n\r\n\r\n\r\n  const pickName = async (acc) => {\r\n    if (!acc) return;\r\n\r\n    setNameQuery(acc.name || \"\");\r\n    setNameSuggest([]);\r\n\r\n    try {\r\n      // ðŸ”‘ Resolve FULL ledger by ID (or mobile fallback)\r\n      let full = null;\r\n\r\n      if (acc.account_id || acc.id) {\r\n        full = await apiAccountById(acc.account_id ?? acc.id);\r\n      } else if (acc.mobile) {\r\n        full = await apiAccountByMobile(acc.mobile);\r\n      }\r\n\r\n      if (!full) return;\r\n\r\n      const normalized = {\r\n        ...full,\r\n        account_id: full.account_id ?? full.id ?? null,\r\n        name: full.name ?? full.account_name ?? \"\",\r\n      };\r\n\r\n      // âœ… SINGLE SOURCE OF TRUTH\r\n      setSelectedAccount(normalized);\r\n      setAccQuery(normalized.name);\r\n      fillBuyerFromAccount(normalized);\r\n    } catch (e) {\r\n      console.error(\"pickName failed:\", e);\r\n    }\r\n  };\r\n\r\n  const pickAccount = async (acc) => {\r\n    console.log(\"Clicked account:\", acc);\r\n\r\n    if (!acc?.account_id) return;\r\n\r\n    try {\r\n      const full = await apiAccountById(acc.account_id);\r\n\r\n      if (!full) return;\r\n\r\n      const normalized = {\r\n        ...full,\r\n        name: full.name ?? full.account_name ?? \"\",\r\n      };\r\n\r\n      setSelectedAccount(normalized);\r\n      setAccQuery(normalized.name);\r\n      fillBuyerFromAccount(normalized);\r\n    \r\n    } catch (e) {\r\n      console.error(\"Account fetch failed\", e);\r\n    } finally {\r\n      setAccSuggest([]);\r\n    }\r\n  };\r\n\r\n\r\n  const fillBuyerFromAccount = (acc) => {\r\n    if (!acc) return;\r\n\r\n    const normalized = {\r\n      account_id: acc.account_id ?? acc.id ?? null,\r\n      name: acc.account_name ?? acc.name ?? \"\",\r\n      mobile: acc.mobile ?? \"\",\r\n    };\r\n\r\n    console.log(\"fillBuyerFromAccount acc:\", acc);\r\n\r\n    setBuyer((b) => ({\r\n      ...b,\r\n      account_id: normalized.account_id,\r\n      name: normalized.name,\r\n      mobile: acc.mobile ?? b.mobile,\r\n      addr1: acc.addr1 ?? b.addr1,\r\n      addr2: acc.addr2 ?? b.addr2,\r\n      city: acc.city ?? b.city,\r\n      pin: String(acc.pin ?? b.pin ?? \"\").replace(/[^0-9]/g, \"\"),\r\n      state: acc.state ?? b.state,\r\n      stateCode: String(acc.stateCode ?? b.stateCode ?? \"\").replace(/[^0-9]/g, \"\"),\r\n      gstin: acc.gstin ?? b.gstin,\r\n      email: acc.email ?? b.email,\r\n      phone: acc.phone ?? b.phone,\r\n    }));\r\n\r\n    // âœ… THIS IS THE MISSING LINK\r\n    setSelectedAccount(normalized);\r\n    setAccQuery(normalized.name);\r\n  };\r\n    // per-line availability status: { exists, stock, can_deliver }\r\n    const [statuses, setStatuses] = useState({});\r\n\r\n    const updateAvailability = async (idx, name, qty) => {\r\n      const vname = (name || \"\").trim();\r\n      const q = Number(qty ?? 0);\r\n      if (!vname) {\r\n        setStatuses((s) => ({ ...s, [idx]: undefined }));\r\n        return;\r\n      }\r\n      try {\r\n        const st = await apiCheckAvailability(vname, Number.isFinite(q) ? q : 0);\r\n        setStatuses((s) => ({ ...s, [idx]: st }));\r\n      } catch {\r\n        setStatuses((s) => ({ ...s, [idx]: undefined }));\r\n      }\r\n    };\r\n\r\n    const lookupFromInventory = (val) => {\r\n      const arr = Array.isArray(inventory) ? inventory : [];\r\n      const byLower = (s) => String(s || \"\").toLowerCase();\r\n\r\n      let found = arr.find((i) => byLower(i.name) === byLower(val));\r\n      if (found) {\r\n        return {\r\n          name: found.name,\r\n          hsn: found.hsn ?? found[\"HSN\"] ?? found[\"HSN CODE\"] ?? \"\",\r\n          gst: Number(found.gst ?? found[\"GST %\"] ?? 0) || 0,\r\n          unit: found.unit ?? found[\"UNIT\"] ?? \"KGS\",\r\n          price: Number(found.price ?? found[\"PRICE\"] ?? 0) || 0,\r\n        };\r\n      }\r\n\r\n      const f2 = arr.find((i) => byLower(i[\"ITEM NAME\"]) === byLower(val));\r\n      if (f2) {\r\n        return {\r\n          name: f2[\"ITEM NAME\"],\r\n          hsn: f2[\"HSN\"] ?? f2[\"HSN CODE\"] ?? \"\",\r\n          gst: Number(f2[\"GST %\"] ?? 0) || 0,\r\n          unit: f2[\"UNIT\"] ?? \"KGS\",\r\n          price: Number(f2[\"PRICE\"] ?? 0) || 0,\r\n        };\r\n      }\r\n      return null;\r\n    };\r\n\r\n    const handleItemChange = async (idx, val) => {\r\n      setActiveQuery(val);\r\n\r\n      let picked = null;\r\n      try {\r\n        if ((val || \"\").trim()) {\r\n          picked = await apiPurchasesLast(val.trim());\r\n        }\r\n      } catch {\r\n        /* ignore */\r\n      }\r\n\r\n      if (!picked) {\r\n        const item = lookupFromInventory(val);\r\n        picked = item\r\n          ? {\r\n              name: item.name,\r\n              hsn: item.hsn || \"\",\r\n              price: Number(item.price || 0),\r\n              gst: Number(item.gst || 0),\r\n              stockQty: 0,\r\n            }\r\n          : null;\r\n      }\r\n\r\n      setLines((prev) => {\r\n        const next = prev.map((r, i) =>\r\n          i !== idx\r\n            ? r\r\n            : {\r\n                ...r,\r\n                itemName: val,\r\n                hsn: picked?.hsn ?? r.hsn,\r\n                unit: \"KG\",\r\n                unitPrice: String(picked?.price ?? r.unitPrice),\r\n                gst: String(picked?.gst ?? r.gst),\r\n              }\r\n        );\r\n        const isNonEmpty = !!(next[idx].itemName || next[idx].qty);\r\n        const hasBlank =\r\n          next.length &&\r\n          !next[next.length - 1].itemName &&\r\n          !next[next.length - 1].qty;\r\n        if (isNonEmpty && !hasBlank) next.push(emptyLine());\r\n        return next;\r\n      });\r\n\r\n      const qtyNow = Number(lines[idx]?.qty || 0);\r\n      updateAvailability(idx, val, qtyNow);\r\n      setSuggest([]);\r\n    };\r\n\r\n    const handleQty = (idx, v) => {\r\n      const clean = String(v).replace(/[^0-9.]/g, \"\");\r\n      setLines((prev) => {\r\n        const next = prev.map((r, i) =>\r\n          i !== idx ? r : { ...r, qty: clean }\r\n        );\r\n        const isNonEmpty = !!(next[idx].itemName || clean);\r\n        const hasBlank =\r\n          next.length &&\r\n          !next[next.length - 1].itemName &&\r\n          !next[next.length - 1].qty;\r\n        if (isNonEmpty && !hasBlank) next.push(emptyLine());\r\n        return next;\r\n      });\r\n      updateAvailability(idx, lines[idx]?.itemName || \"\", clean);\r\n    };\r\n\r\n    const handlePrice = (idx, v) =>\r\n      setLines((prev) =>\r\n        prev.map((r, i) =>\r\n          i !== idx\r\n            ? r\r\n            : { ...r, unitPrice: String(v).replace(/[^0-9.]/g, \"\") }\r\n        )\r\n      );\r\n    const handleHSN = (idx, v) =>\r\n      setLines((prev) =>\r\n        prev.map((r, i) => (i !== idx ? r : { ...r, hsn: v }))\r\n      );\r\n    const handleGST = (idx, v) =>\r\n      setLines((prev) =>\r\n        prev.map((r, i) =>\r\n          i !== idx\r\n            ? r\r\n            : { ...r, gst: String(v).replace(/[^0-9.]/g, \"\") }\r\n        )\r\n      );\r\n   /* const handleUnit = (idx, v) =>\r\n      setLines((prev) =>\r\n        prev.map((r, i) => (i !== idx ? r : { ...r, unit: v }))\r\n      );*/\r\n    const addRow = () => setLines((prev) => [...prev, emptyLine()]);\r\n    const removeRow = (idx) => {\r\n      setLines((prev) => prev.filter((_, i) => i !== idx));\r\n      setStatuses((s) => {\r\n        const { [idx]: _omit, ...rest } = s;\r\n        return rest;\r\n      });\r\n    };\r\n\r\n    // ============ totals (with GST rounding) ============\r\n    const computed = useMemo(() => {\r\n      const filled = lines.filter((l) => l.itemName && Number(l.qty) > 0);\r\n\r\n      const baseRows = filled.map((l) => {\r\n        const qty = Number(l.qty || 0);\r\n        const rate = Number(l.unitPrice || 0);\r\n        const gstRate = Number(l.gst || 0);\r\n        const lineTaxable = qty * rate;\r\n        return { ...l, qty, rate, gstRate, lineTaxable };\r\n      });\r\n\r\n      const taxable = baseRows.reduce((s, r) => s + r.lineTaxable, 0);\r\n\r\n      const pct = Math.max(0, Number(discountPct || 0));\r\n      const discountAmount = +(taxable * (pct / 100)).toFixed(2);\r\n      const discountedTaxable = +(taxable - discountAmount).toFixed(2);\r\n\r\n      const factor = taxable > 0 ? 1 - pct / 100 : 1;\r\n\r\n      let cgstRaw = 0,\r\n        sgstRaw = 0,\r\n        igstRaw = 0;\r\n      baseRows.forEach((r) => {\r\n        const discLineTaxable = r.lineTaxable * factor;\r\n        const lineGST = discLineTaxable * (r.gstRate / 100);\r\n        if (\r\n          (buyer.stateCode || \"\").trim() !==\r\n          (company?.stateCode || \"\").trim()\r\n        ) {\r\n          igstRaw += lineGST;\r\n        } else {\r\n          cgstRaw += lineGST / 2;\r\n          sgstRaw += lineGST / 2;\r\n        }\r\n      });\r\n\r\n      const rawGSTTotal = cgstRaw + sgstRaw + igstRaw;\r\n\r\n      const roundRupee = (x) => Math.round(x);\r\n      const isInter =\r\n        (buyer.stateCode || \"\").trim() !==\r\n        (company?.stateCode || \"\").trim();\r\n      const cgstRounded = isInter ? 0 : roundRupee(cgstRaw);\r\n      const sgstRounded = isInter ? 0 : roundRupee(sgstRaw);\r\n      const igstRounded = isInter ? roundRupee(igstRaw) : 0;\r\n      const gstRounded = isInter ? igstRounded : cgstRounded + sgstRounded;\r\n\r\n      const roundOff = +(gstRounded - rawGSTTotal).toFixed(2);\r\n      const total = +(discountedTaxable + gstRounded).toFixed(2);\r\n      const grand = total;\r\n\r\n      return {\r\n        rows: baseRows,\r\n        taxable,\r\n        discountAmount,\r\n        discountedTaxable,\r\n        rawGSTTotal,\r\n        cgstRounded,\r\n        sgstRounded,\r\n        igstRounded,\r\n        gstRounded,\r\n        roundOff,\r\n        total,\r\n        grand,\r\n      };\r\n    }, [lines, discountPct, buyer.stateCode, company?.stateCode]);\r\n\r\n    const isInterState = useMemo(\r\n      () =>\r\n        (buyer.stateCode || \"\").trim() !==\r\n        (company?.stateCode || \"\").trim(),\r\n      [buyer.stateCode, company?.stateCode]\r\n    );\r\n\r\n    // Split: paid now & balance\r\n    const paidNow = useMemo(() => {\r\n      const s1 = splitEnabled ? n(split1.amount) : 0;\r\n      const s2 = splitEnabled ? n(split2.amount) : 0;\r\n      return n(advance) + s1 + s2;\r\n    }, [advance, splitEnabled, split1.amount, split2.amount]);\r\n\r\n    const balanceAfterSplits = useMemo(\r\n      () => Math.max(0, +(computed.grand - paidNow).toFixed(2)),\r\n      [computed.grand, paidNow]\r\n    );\r\n\r\n    // ====== Export Excel (with split details) ======\r\n    const exportExcel = () => {\r\n      const consigneeForExcel = consigneeDifferent ? consignee : buyer;\r\n\r\n      const pct = Math.max(0, Number(discountPct || 0));\r\n      const factor = 1 - pct / 100;\r\n\r\n      const invoiceAdvance = n(advance);\r\n      const split1Amt = splitEnabled ? n(split1.amount) : 0;\r\n      const split2Amt = splitEnabled ? n(split2.amount) : 0;\r\n      const invoicePaidNow = invoiceAdvance + split1Amt + split2Amt;\r\n      const invoiceBalance = +(computed.grand - invoicePaidNow).toFixed(2);\r\n\r\n      const rows = (computed.rows.length ? computed.rows : []).map((r, idx) => {\r\n        const lineTaxableDisc = +(r.lineTaxable * factor).toFixed(2);\r\n        const lineGSTRaw = lineTaxableDisc * (r.gstRate / 100);\r\n\r\n        const cgstP = isInterState ? 0 : r.gstRate / 2;\r\n        const sgstP = isInterState ? 0 : r.gstRate / 2;\r\n        const igstP = isInterState ? r.gstRate : 0;\r\n\r\n        const totalVal = lineTaxableDisc + lineGSTRaw;\r\n        const roundOffForRow = idx === 0 ? computed.roundOff : 0;\r\n\r\n        return {\r\n          \"VOUCHER TYPE\": \"Sales\",\r\n          DATE: fmtDDMMYYYY(invMeta.date),\r\n          \"VOUCHER NUMBER\": invMeta.invoiceNo,\r\n          \"PARTY NAME\": buyer.name || \"\",\r\n          GSTIN: buyer.gstin || \"\",\r\n          ADDRESS: `${buyer.addr1 || \"\"} ${buyer.addr2 || \"\"}`.trim(),\r\n          STATE: buyer.state || \"\",\r\n          \"BUYER CITYPIN\": buyer.city || \"\",\r\n          \"BUYER STATE CODE\": buyer.stateCode || \"\",\r\n          \"CONSIGNEE NAME\": consigneeForExcel.name || \"\",\r\n          \"CONSIGNEE ADDRESS\": `${consigneeForExcel.addr1 || \"\"} ${\r\n            consigneeForExcel.addr2 || \"\"\r\n          }`.trim(),\r\n          \"CONSIGNEE CITYPIN\": consigneeForExcel.city || \"\",\r\n          \"CONSIGNEE STATE\": consigneeForExcel.state || \"\",\r\n          \"CONSIGNEE STATE CODE\": consigneeForExcel.stateCode || \"\",\r\n          \"ITEM NAME\": r.itemName || \"\",\r\n          \"HSN CODE\": r.hsn || \"\",\r\n          QTY: r.qty || 0,\r\n          UOM: r.unit || \"KG\",\r\n          RATE: r.rate || 0,\r\n          \"TAXABLE VALUE\": +lineTaxableDisc.toFixed(2),\r\n          \"CGST %\": cgstP,\r\n          \"SGST %\": sgstP,\r\n          \"IGST %\": igstP,\r\n          \"TOTAL VALUE\": +totalVal.toFixed(2),\r\n          NARRATION: paymentMode\r\n            ? `Sale of goods â€” Payment: ${paymentMode}` +\r\n              (splitEnabled\r\n                ? `; Split1 ${split1Amt} ${split1.mode}${\r\n                    split1.ref ? \" (\" + split1.ref + \")\" : \"\"\r\n                  }; Split2 ${split2Amt} ${split2.mode}${\r\n                    split2.ref ? \" (\" + split2.ref + \")\" : \"\"\r\n                  }`\r\n                : \"\")\r\n            : splitEnabled\r\n            ? `Sale of goods â€” Split1 ${split1Amt} ${split1.mode}${\r\n                split1.ref ? \" (\" + split1.ref + \")\" : \"\"\r\n              }; Split2 ${split2Amt} ${split2.mode}${\r\n                split2.ref ? \" (\" + split2.ref + \")\" : \"\"\r\n              }`\r\n            : \"Sale of goods\",\r\n          \"ROUND OFF\": roundOffForRow,\r\n          \"PLACE OF SUPPLY\": buyer.state || \"\",\r\n          \"TERMS OF PAYMENT\": paymentMode || \"\",\r\n          \"EWAY BILL NO\": invMeta.ewayNo || \"\",\r\n          \"LR DATE\": invMeta.lrDate || \"\",\r\n          \"INV TAXABLE TOTAL\": +computed.taxable.toFixed(2),\r\n          \"INV DISCOUNT %\": pct,\r\n          \"INV DISCOUNT AMOUNT\": +computed.discountAmount.toFixed(2),\r\n          \"INV TAXABLE AFTER DISC\": +computed.discountedTaxable.toFixed(2),\r\n          \"INV GST TOTAL\": +computed.gstRounded.toFixed(2),\r\n          \"INV ROUND OFF\": +computed.roundOff.toFixed(2),\r\n          \"INV GRAND TOTAL\": +computed.grand.toFixed(2),\r\n          \"INV ADVANCE\": invoiceAdvance,\r\n          \"INV SPLIT1 AMT\": split1Amt,\r\n          \"INV SPLIT1 MODE\": splitEnabled ? split1.mode : \"\",\r\n          \"INV SPLIT1 REF\": splitEnabled ? split1.ref : \"\",\r\n          \"INV SPLIT2 AMT\": split2Amt,\r\n          \"INV SPLIT2 MODE\": splitEnabled ? split2.mode : \"\",\r\n          \"INV SPLIT2 REF\": splitEnabled ? split2.ref : \"\",\r\n          \"INV PAID NOW\": invoicePaidNow,\r\n          \"INV BALANCE\": invoiceBalance,\r\n        };\r\n      });\r\n\r\n      const data =\r\n        rows.length > 0\r\n          ? rows\r\n          : [\r\n              {\r\n                \"VOUCHER TYPE\": \"Sales\",\r\n                DATE: fmtDDMMYYYY(invMeta.date),\r\n                \"VOUCHER NUMBER\": invMeta.invoiceNo,\r\n                \"PARTY NAME\": buyer.name || \"\",\r\n                GSTIN: buyer.gstin || \"\",\r\n                ADDRESS: `${buyer.addr1 || \"\"} ${buyer.addr2 || \"\"}`.trim(),\r\n                STATE: buyer.state || \"\",\r\n                \"BUYER CITYPIN\": buyer.city || \"\",\r\n                \"BUYER STATE CODE\": buyer.stateCode || \"\",\r\n                \"CONSIGNEE NAME\": consigneeForExcel.name || \"\",\r\n                \"CONSIGNEE ADDRESS\": `${consigneeForExcel.addr1 || \"\"} ${\r\n                  consigneeForExcel.addr2 || \"\"\r\n                }`.trim(),\r\n                \"CONSIGNEE CITYPIN\": consigneeForExcel.city || \"\",\r\n                \"CONSIGNEE STATE\": consigneeForExcel.state || \"\",\r\n                \"CONSIGNEE STATE CODE\": consigneeForExcel.stateCode || \"\",\r\n                \"ITEM NAME\": \"\",\r\n                \"HSN CODE\": \"\",\r\n                QTY: 0,\r\n                UOM: \"KGS\",\r\n                RATE: 0,\r\n                \"TAXABLE VALUE\": 0,\r\n                \"CGST %\": 0,\r\n                \"SGST %\": 0,\r\n                \"IGST %\": 0,\r\n                \"TOTAL VALUE\": 0,\r\n                NARRATION: paymentMode\r\n                  ? `Sale of goods â€” Payment: ${paymentMode}`\r\n                  : \"Sale of goods\",\r\n                \"ROUND OFF\": computed.roundOff || 0,\r\n                \"PLACE OF SUPPLY\": buyer.state || \"\",\r\n                \"TERMS OF PAYMENT\": paymentMode || \"\",\r\n                \"EWAY BILL NO\": invMeta.ewayNo || \"\",\r\n                \"LR DATE\": invMeta.lrDate || \"\",\r\n                \"INV TAXABLE TOTAL\": +computed.taxable.toFixed(2),\r\n                \"INV DISCOUNT %\": pct,\r\n                \"INV DISCOUNT AMOUNT\": +computed.discountAmount.toFixed(2),\r\n                \"INV TAXABLE AFTER DISC\":\r\n                  +computed.discountedTaxable.toFixed(2),\r\n                \"INV GST TOTAL\": +computed.gstRounded.toFixed(2),\r\n                \"INV ROUND OFF\": +computed.roundOff.toFixed(2),\r\n                \"INV GRAND TOTAL\": +computed.grand.toFixed(2),\r\n                \"INV ADVANCE\": invoiceAdvance,\r\n                \"INV SPLIT1 AMT\": split1Amt,\r\n                \"INV SPLIT1 MODE\": splitEnabled ? split1.mode : \"\",\r\n                \"INV SPLIT1 REF\": splitEnabled ? split1.ref : \"\",\r\n                \"INV SPLIT2 AMT\": split2Amt,\r\n                \"INV SPLIT2 MODE\": splitEnabled ? split2.mode : \"\",\r\n                \"INV SPLIT2 REF\": splitEnabled ? split2.ref : \"\",\r\n                \"INV PAID NOW\": invoicePaidNow,\r\n                \"INV BALANCE\": invoiceBalance,\r\n              },\r\n            ];\r\n\r\n      const ws = XLSX.utils.json_to_sheet(data, {\r\n        header: [\r\n          \"VOUCHER TYPE\",\r\n          \"DATE\",\r\n          \"VOUCHER NUMBER\",\r\n          \"PARTY NAME\",\r\n          \"GSTIN\",\r\n          \"ADDRESS\",\r\n          \"STATE\",\r\n          \"BUYER CITYPIN\",\r\n          \"BUYER STATE CODE\",\r\n          \"CONSIGNEE NAME\",\r\n          \"CONSIGNEE ADDRESS\",\r\n          \"CONSIGNEE CITYPIN\",\r\n          \"CONSIGNEE STATE\",\r\n          \"CONSIGNEE STATE CODE\",\r\n          \"ITEM NAME\",\r\n          \"HSN CODE\",\r\n          \"QTY\",\r\n          \"UOM\",\r\n          \"RATE\",\r\n          \"TAXABLE VALUE\",\r\n          \"CGST %\",\r\n          \"SGST %\",\r\n          \"IGST %\",\r\n          \"TOTAL VALUE\",\r\n          \"NARRATION\",\r\n          \"ROUND OFF\",\r\n          \"PLACE OF SUPPLY\",\r\n          \"TERMS OF PAYMENT\",\r\n          \"EWAY BILL NO\",\r\n          \"LR DATE\",\r\n          \"INV TAXABLE TOTAL\",\r\n          \"INV DISCOUNT %\",\r\n          \"INV DISCOUNT AMOUNT\",\r\n          \"INV TAXABLE AFTER DISC\",\r\n          \"INV GST TOTAL\",\r\n          \"INV ROUND OFF\",\r\n          \"INV GRAND TOTAL\",\r\n          \"INV ADVANCE\",\r\n          \"INV SPLIT1 AMT\",\r\n          \"INV SPLIT1 MODE\",\r\n          \"INV SPLIT1 REF\",\r\n          \"INV SPLIT2 AMT\",\r\n          \"INV SPLIT2 MODE\",\r\n          \"INV SPLIT2 REF\",\r\n          \"INV PAID NOW\",\r\n          \"INV BALANCE\",\r\n        ],\r\n      });\r\n\r\n      const wb = XLSX.utils.book_new();\r\n      XLSX.utils.book_append_sheet(wb, ws, \"Invoice\");\r\n      const fileName = `Invoice_${invMeta.invoiceNo.replace(\r\n        /[\\/\\\\:*?\"<>|]/g,\r\n        \"-\"\r\n      )}.xlsx`;\r\n      XLSX.writeFile(wb, fileName);\r\n    };\r\n\r\n    // ===================== PRINT (with split payment details) =====================\r\n    const printNow = () => {\r\n      const missing = [];\r\n      if (!buyer.name.trim()) missing.push(\"Buyer Name\");\r\n      if (!buyer.addr1.trim()) missing.push(\"Buyer Address 1\");\r\n      if (!buyer.city.trim()) missing.push(\"Buyer City\");\r\n      if (!buyer.pin?.trim?.()) missing.push(\"Buyer PIN\");\r\n\r\n      if (missing.length) {\r\n        alert(\"Please fill mandatory fields:\\n\" + missing.join(\"\\n\"));\r\n        return;\r\n      }\r\n\r\n      const issues = [];\r\n      lines.forEach((l, i) => {\r\n        if (!l.itemName || !Number(l.qty)) return;\r\n        const st = statuses[i];\r\n        if (!st?.exists) issues.push(`Row ${i + 1}: Item not found in inventory`);\r\n        else if (!st?.can_deliver)\r\n          issues.push(`Row ${i + 1}: Only ${st.stock} in stock`);\r\n      });\r\n      if (issues.length) {\r\n        alert(\"Please fix before printing:\\n\" + issues.join(\"\\n\"));\r\n        return;\r\n      }\r\n\r\n      const wnd = window.open(\"\", \"_blank\");\r\n      if (!wnd) return;\r\n\r\n      const useConsignee = consigneeDifferent ? consignee : buyer;\r\n      const fmtL = (d) =>\r\n        new Date(d).toLocaleDateString(\"en-IN\", {\r\n          day: \"2-digit\",\r\n          month: \"short\",\r\n          year: \"numeric\",\r\n        });\r\n\r\n      // build invoice rows for print\r\n      const rowHtmlArr = (computed.rows.length ? computed.rows : []).map(\r\n        (r, i) => {\r\n          const pct = Math.max(0, Number(discountPct || 0));\r\n          const factor = 1 - pct / 100;\r\n\r\n          const lineBase = r.lineTaxable;\r\n          const lineTaxableDisc = +(r.lineTaxable * factor).toFixed(2);\r\n          const amountWithTaxRaw =\r\n            lineTaxableDisc + (lineTaxableDisc * r.gstRate) / 100;\r\n\r\n          const taxLabel = r.gstRate\r\n            ? isInterState\r\n              ? `${r.gstRate}% IGST`\r\n              : `${(r.gstRate / 2).toFixed(0)}% + ${(r.gstRate / 2).toFixed(\r\n                  0\r\n                )}%`\r\n            : \"-\";\r\n\r\n          return `\r\n          <tr>\r\n            <td class=\"c\">${i + 1}</td>\r\n            <td>${escapeHtml(r.itemName)}</td>\r\n            <td class=\"c\">${escapeHtml(r.hsn || \"\")}</td>\r\n            <td class=\"r\">${r.qty}</td>\r\n            <td class=\"c\">${escapeHtml(r.unit || \"KGS\")}</td>\r\n            <td class=\"r\">${toINR(r.rate)}</td>\r\n            <td class=\"r\">${toINR(lineBase)}</td>\r\n            <td class=\"c\">${taxLabel}</td>\r\n            <td class=\"r\">${toINR(amountWithTaxRaw)}</td>\r\n          </tr>`;\r\n        }\r\n      );\r\n\r\n      // pad rows to fixed count (10)\r\n      const TARGET_ROWS = 10;\r\n      const blankCount = Math.max(0, TARGET_ROWS - rowHtmlArr.length);\r\n      for (let k = 0; k < blankCount; k++) {\r\n        rowHtmlArr.push(`\r\n          <tr>\r\n            <td class=\"c\">&nbsp;</td>\r\n            <td>&nbsp;</td>\r\n            <td class=\"c\">&nbsp;</td>\r\n            <td class=\"r\">&nbsp;</td>\r\n            <td class=\"c\">&nbsp;</td>\r\n            <td class=\"r\">&nbsp;</td>\r\n            <td class=\"r\">&nbsp;</td>\r\n            <td class=\"c\">&nbsp;</td>\r\n            <td class=\"r\">&nbsp;</td>\r\n          </tr>`);\r\n      }\r\n\r\n      const rowsHtml =\r\n        rowHtmlArr.join(\"\") ||\r\n        `<tr><td colspan=\"9\" class=\"c muted\">No items</td></tr>`;\r\n\r\n      const cssHref =\r\n        Array.from(document.styleSheets)\r\n          .map((s) => s.href)\r\n          .filter(Boolean)\r\n          .find((h) => h.includes(\"BillingPanel.css\")) || \"BillingPanel.css\";\r\n\r\n      // totals used in print\r\n      const adv = paidNow; // advance + split payments\r\n      const balanceDue = balanceAfterSplits;\r\n\r\n      // NEW: split details rows\r\n      const splitLinesHtml = splitEnabled\r\n        ? `\r\n              <tr><td colspan=\"8\" class=\"r\">Split #1 (${escapeHtml(\r\n                split1.mode || \"-\"\r\n              )})</td><td class=\"r\">${toINR(n(split1.amount))}</td></tr>\r\n              ${\r\n                n(split2.amount) > 0\r\n                  ? `<tr><td colspan=\"8\" class=\"r\">Split #2 (${escapeHtml(\r\n                      split2.mode || \"-\"\r\n                    )})</td><td class=\"r\">${toINR(n(split2.amount))}</td></tr>`\r\n                  : \"\"\r\n              }\r\n          `\r\n        : \"\";\r\n\r\n      const html = `<!doctype html><html><head><meta charset=\"utf-8\" />\r\n        <title>Tax Invoice</title>\r\n        <link rel=\"stylesheet\" href=\"${cssHref}\">\r\n        <style>\r\n          @page { size: A4; margin: 10mm; }\r\n          @media print {\r\n            html, body { width: 210mm; }\r\n            .shell { border: 0; padding: 0; }\r\n            table { page-break-inside: auto; }\r\n            tr { page-break-inside: avoid; break-inside: avoid; }\r\n            thead { display: table-header-group; }\r\n            tfoot { display: table-footer-group; }\r\n          }\r\n          body{font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial; margin:16px}\r\n          .small{font-size:12px;color:#555}\r\n          .muted{color:#6b7280}\r\n          .r{text-align:right}.c{text-align:center}\r\n          .shell{border:1px solid #111; padding:12px}\r\n          .grid{display:grid; grid-template-columns: 1.2fr .9fr; gap:12px}\r\n          .box{border:1px solid #111; padding:8px}\r\n          .two{display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-top:8px}\r\n          .foot{display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:8px}\r\n          .hr{border-top:1px solid #ddd; margin:6px 0}\r\n          table{width:100%; border-collapse:collapse; margin-top:8px}\r\n          th,td{border:1px solid #111; padding:6px; font-size:13px}\r\n          th{background:#f9fafb; white-space:nowrap}\r\n          td:nth-child(2){word-break:break-word}\r\n          tbody tr:nth-child(odd){background:#fcfcfc}\r\n        </style>\r\n      </head>\r\n      <body class=\"invoice-print\">\r\n        <div class=\"shell\">\r\n          <div class=\"grid\">\r\n            <div class=\"box\">\r\n              <div style=\"display:flex;justify-content:space-between;align-items:center\">\r\n                <div>\r\n                  <div style=\"font-size:18px;font-weight:700\">${escapeHtml(\r\n                    company?.name || \"\"\r\n                  )}</div>\r\n                  <div class=\"small\">${escapeHtml(company?.addr1 || \"\")}</div>\r\n                  <div class=\"small\">${escapeHtml(company?.addr2 || \"\")}</div>\r\n                  <div class=\"small\">${escapeHtml(company?.city || \"\")}</div>\r\n                  <div class=\"small\">State: ${escapeHtml(\r\n                    company?.state || \"-\"\r\n                  )}, Code: ${escapeHtml(company?.stateCode || \"-\")}</div>\r\n                  <div class=\"small\">GSTIN/UIN: ${escapeHtml(\r\n                    company?.gstin || \"-\"\r\n                  )}</div>\r\n                  ${\r\n                    company?.email\r\n                      ? `<div class=\"small\">E-Mail : ${escapeHtml(\r\n                          company.email\r\n                        )}</div>`\r\n                      : \"\"\r\n                  }\r\n                  ${\r\n                    company?.mobile || company?.phone || company?.whatsapp\r\n                      ? `<div class=\"small\">Phone : ${escapeHtml(\r\n                          [company.mobile, company.phone]\r\n                            .filter(Boolean)\r\n                            .join(\" / \")\r\n                        )}${\r\n                          company?.whatsapp\r\n                            ? \" | WhatsApp: \" + escapeHtml(company.whatsapp)\r\n                            : \"\"\r\n                        }</div>`\r\n                      : \"\"\r\n                  }\r\n                </div>\r\n                <div style=\"font-size:12px;font-weight:700\">Tax invoice</div>\r\n              </div>\r\n\r\n              <div class=\"two\">\r\n                <div class=\"box\">\r\n                  <div style=\"font-weight:600;font-size:12px\">Consignee (Ship To)</div>\r\n                  <div style=\"font-weight:600\">${escapeHtml(\r\n                    useConsignee.name || \"-\"\r\n                  )}</div>\r\n                  \r\n                  <div class=\"small\">${escapeHtml(\r\n                    useConsignee.addr1 || \"\"\r\n                  )}</div>\r\n                  <div class=\"small\">${escapeHtml(\r\n                    useConsignee.addr2 || \"\"\r\n                  )}</div>\r\n                  <div class=\"small\">${escapeHtml(\r\n                    useConsignee.city || \"\"\r\n                  )}</div>\r\n                  <div class=\"small\">State: ${escapeHtml(\r\n                    useConsignee.state || \"-\"\r\n                  )}, Code: ${escapeHtml(useConsignee.stateCode || \"-\")}</div>\r\n                  <div class=\"small\">GSTIN/UIN: ${escapeHtml(\r\n                    useConsignee.gstin || \"-\"\r\n                  )}</div>\r\n                </div>\r\n                <div class=\"box\">\r\n                  <div style=\"font-weight:600;font-size:12px\">Buyer (Bill To)</div>\r\n                  <div style=\"font-weight:600\">${escapeHtml(\r\n                    buyer.name || \"-\"\r\n                  )}</div>\r\n                    ${\r\n      buyer.mobile\r\n        ? `<div class=\"small\">Mobile: ${escapeHtml(buyer.mobile)}</div>`\r\n        : \"\"\r\n    }\r\n                  \r\n                  <div class=\"small\">${escapeHtml(buyer.addr1 || \"\")}</div>\r\n                  <div class=\"small\">${escapeHtml(buyer.addr2 || \"\")}</div>\r\n                  <div class=\"small\">${escapeHtml(buyer.city || \"\")}</div>\r\n                  <div class=\"small\">State: ${escapeHtml(\r\n                    buyer.state || \"-\"\r\n                  )}, Code: ${escapeHtml(buyer.stateCode || \"-\")}</div>\r\n                  <div class=\"small\">GSTIN/UIN: ${escapeHtml(\r\n                    buyer.gstin || \"-\"\r\n                  )}</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"box\">\r\n              <table>\r\n                <tbody>\r\n                  <tr><td style=\"width:45%\">Invoice No</td><td>${escapeHtml(\r\n                    invMeta.invoiceNo\r\n                  )}</td></tr>\r\n                  <tr><td>Date</td><td>${fmtL(invMeta.date)}</td></tr>\r\n                  <tr><td>Terms of Payment</td><td>${escapeHtml(\r\n                    paymentMode || \"-\"\r\n                  )}</td></tr>\r\n                  <tr>\r\n                    <td>Payment Receipt No</td>\r\n                    <td>${escapeHtml(paymentReceiptNo || \"-\")}</td>\r\n                  </tr>\r\n                  <tr><td>e-Way Bill No</td><td>${escapeHtml(\r\n                    invMeta.ewayNo || \"-\"\r\n                  )}</td></tr>\r\n                  <tr><td>LR / Date</td><td>${escapeHtml(\r\n                    invMeta.lrDate || \"-\"\r\n                  )}</td></tr>\r\n                  <tr><td>Vehicle No</td><td>${escapeHtml(\r\n                    invMeta.vehicleNo || \"-\"\r\n                  )}</td></tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n\r\n          <table style=\"margin-top:8px\">\r\n            <thead>\r\n              <tr>\r\n                <th style=\"width:36px\">S.No</th>\r\n                <th>Description of Goods</th>\r\n                <th>HSN/SAC</th>\r\n                <th class=\"r\">Quantity</th>\r\n                <th>Unit</th>\r\n                <th class=\"r\">Rate</th>\r\n                <th class=\"r\">Price</th>\r\n                <th class=\"c\">GST %</th>\r\n                <th class=\"r\">Amount</th>\r\n              </tr>\r\n            </thead>\r\n\r\n            <tbody>\r\n              ${rowsHtml}\r\n              <tr><td colspan=\"8\" class=\"r\"><b>Taxable Value</b></td><td class=\"r\"><b>${toINR(\r\n                computed.taxable\r\n              )}</b></td></tr>\r\n              <tr><td colspan=\"8\" class=\"r\">Discount (${Number(\r\n                discountPct || 0\r\n              )}%)</td><td class=\"r\">-${toINR(\r\n        computed.discountAmount\r\n      )}</td></tr>\r\n              <tr><td colspan=\"8\" class=\"r\">Taxable After Discount</td><td class=\"r\">${toINR(\r\n                computed.discountedTaxable\r\n              )}</td></tr>\r\n              ${\r\n                isInterState\r\n                  ? `<tr><td colspan=\"8\" class=\"r\"><b>IGST (rounded)</b></td><td class=\"r\"><b>${toINR(\r\n                      computed.igstRounded\r\n                    )}</b></td></tr>`\r\n                  : `<tr><td colspan=\"8\" class=\"r\">CGST (rounded)</td><td class=\"r\">${toINR(\r\n                      computed.cgstRounded\r\n                    )}</td></tr>\r\n                    <tr><td colspan=\"8\" class=\"r\">SGST (rounded)</td><td class=\"r\">${toINR(\r\n                      computed.sgstRounded\r\n                    )}</td></tr>`\r\n              }\r\n              <tr><td colspan=\"8\" class=\"r\">Round Off (GST rounding)</td><td class=\"r\">${toINR(\r\n                computed.roundOff\r\n              )}</td></tr>\r\n              <tr><td colspan=\"8\" class=\"r\"><b>Total</b></td><td class=\"r\"><b>${toINR(\r\n                computed.total\r\n              )}</b></td></tr>\r\n              <tr><td colspan=\"8\" class=\"r\"><b>Grand Total</b></td><td class=\"r\"><b>${toINR(\r\n                computed.grand\r\n              )}</b></td></tr>\r\n\r\n              ${splitLinesHtml}\r\n\r\n              <tr><td colspan=\"8\" class=\"r\">Advance / Received</td><td class=\"r\">-${toINR(\r\n                adv\r\n              )}</td></tr>\r\n              <tr><td colspan=\"8\" class=\"r\"><b>Balance Due</b></td><td class=\"r\"><b>${toINR(\r\n                balanceDue\r\n              )}</b></td></tr>\r\n            </tbody>\r\n          </table>\r\n\r\n          <div class=\"foot\">\r\n            <div class=\"box\">\r\n              <div><b>Amount Chargeable (in words)</b></div>\r\n              <div class=\"small\" style=\"margin-top:4px\">INR ${numberToWordsIndian(\r\n                Math.round(computed.grand)\r\n              )} Only</div>\r\n              <div class=\"hr\"></div>\r\n              <div class=\"small\"><b>Tax Amount (in words)</b></div>\r\n              <div class=\"small\">INR ${numberToWordsIndian(\r\n                Math.round(computed.gstRounded)\r\n              )} Only</div>\r\n            </div>\r\n            <div class=\"box\">\r\n              <div class=\"small\"><b>Company's Bank Details</b></div>\r\n              ${\r\n                defaultBank\r\n                  ? `\r\n                <div class=\"small\">Bank : ${escapeHtml(\r\n                  defaultBank.bankName || \"\"\r\n                )}</div>\r\n                <div class=\"small\">Branch & IFSC : ${escapeHtml(\r\n                  defaultBank.branch || \"\"\r\n                )} & ${escapeHtml(\r\n                      defaultBank.ifsc || \"\"\r\n                    )}</div>\r\n                <div class=\"small\">A/C No : ${escapeHtml(\r\n                  defaultBank.account || \"\"\r\n                )}</div>`\r\n                  : `<div class=\"small\">No bank selected</div>`\r\n              }\r\n              <div class=\"hr\"></div>\r\n              <div class=\"small c\">For ${escapeHtml(company?.name || \"\")}</div>\r\n              <div style=\"height:48px\"></div>\r\n              <div class=\"small r\">Authorised Signatory</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"small\" style=\"margin-top:8px\">\r\n            <b>Declaration:</b> We declare that this invoice shows the actual price of the goods described and that all particulars are true and correct.\r\n            <div>SUBJECT TO TRICHY JURISDICTION</div>\r\n          </div>\r\n        </div>\r\n        <script>window.onload = () => window.print();</script>\r\n      </body></html>`;\r\n\r\n      wnd.document.write(html);\r\n      wnd.document.close();\r\n    };\r\n\r\n    // ================= UI =================\r\n    return (\r\n      <div className=\"billing-full card\">\r\n        <div className=\"row\">\r\n          {/* Invoice meta */}\r\n          <div>\r\n            <div className=\"form-grid-4\" style={{ marginTop: 6 }}>\r\n            <div className=\"form-grid-3\" style={{ marginTop: 6 }}>\r\n    {/* Invoice Type */}\r\n    <div>\r\n      <label>Invoice Type</label>\r\n      <select\r\n        value={invoiceType}\r\n        onChange={(e) => setInvoiceType(e.target.value)}\r\n      >\r\n        <option value=\"B2C\">B2C</option>\r\n        <option value=\"B2B\">B2B</option>\r\n      </select>\r\n    </div>\r\n\r\n    {/* Date */}\r\n    <div>\r\n      <label>Date</label>\r\n      <input\r\n        type=\"date\"\r\n        value={invMeta.date}\r\n        onChange={(e) =>\r\n          setInvMeta((m) => ({ ...m, date: e.target.value }))\r\n        }\r\n      />\r\n    </div>\r\n  </div>\r\n\r\n              <div\r\n                style={{ display: \"flex\", gap: \"20px\", alignItems: \"center\" }}\r\n              >\r\n                <div className=\"meta-row\">\r\n                  <div className=\"meta-field\">\r\n                    <label>eWay Bill No</label>\r\n                    <input\r\n                      value={invMeta.ewayNo}\r\n                      onChange={(e) =>\r\n                        setInvMeta((m) => ({ ...m, ewayNo: e.target.value }))\r\n                      }\r\n                    />\r\n                  </div>\r\n                  <div className=\"meta-field\">\r\n                  <label>Vehicle No</label>\r\n                    <input\r\n                      value={invMeta.vehicleNo}\r\n                      onChange={(e) =>\r\n                        setInvMeta((m) => ({ ...m, vehicleNo: e.target.value.toUpperCase() }))\r\n                      }\r\n                      placeholder=\"Vehicle No.\"\r\n                    />\r\n                  </div>\r\n\r\n\r\n                  <div className=\"meta-field\">\r\n                    <label>KMs</label>\r\n                    <input\r\n                      value={invMeta.kms || \"\"}\r\n                      onChange={(e) =>\r\n                        setInvMeta((m) => ({\r\n                          ...m,\r\n                          kms: e.target.value.replace(/[^0-9]/g, \"\"),\r\n                        }))\r\n                      }\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"meta-field\">\r\n                    <label>From Date</label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={invMeta.fromDate || \"\"}\r\n                      onChange={(e) =>\r\n                        setInvMeta((m) => ({ ...m, fromDate: e.target.value }))\r\n                      }\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"meta-field\">\r\n                    <label>To Date</label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={invMeta.toDate || \"\"}\r\n                      onChange={(e) =>\r\n                        setInvMeta((m) => ({ ...m, toDate: e.target.value }))\r\n                      }\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              {/*\r\n              <div>\r\n                <label>LR Date</label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={invMeta.lrDate}\r\n                  onChange={(e) =>\r\n                    setInvMeta((m) => ({ ...m, lrDate: e.target.value }))\r\n                  }\r\n                />\r\n              </div>\r\n              */}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Buyer */}\r\n          <div>\r\n            <div className=\"small\">Buyer (Bill To)</div>\r\n            <div className=\"form-grid-4\" style={{ marginTop: 6 }}>\r\n            <div className=\"row-2\">\r\n    <div style={{ position: \"relative\" }}>\r\n    <label>Name *</label>\r\n    <input\r\n      value={buyer.name}\r\n      onChange={(e) => {\r\n        const v = e.target.value;\r\n        setBuyer((b) => ({ ...b, name: v }));\r\n        setNameQuery(v);\r\n      }}\r\n      onFocus={() => setNameQuery(buyer.name || \" \")}\r\n      placeholder=\"Type buyer name...\"\r\n      autoComplete=\"off\"\r\n    />\r\n\r\n    {/* dropdown */}\r\n    {nameSuggest.length > 0 && (\r\n      <div\r\n        style={{\r\n          position: \"absolute\",\r\n          top: \"100%\",\r\n          left: 0,\r\n          right: 0,\r\n          background: \"#fff\",\r\n          border: \"1px solid #ddd\",\r\n          zIndex: 50,\r\n          maxHeight: 220,\r\n          overflowY: \"auto\",\r\n          borderRadius: 8,\r\n        }}\r\n      >\r\n        {nameSuggest.map((a, idx) => (\r\n          <div\r\n            key={`${a.mobile || \"\"}-${idx}`}\r\n            onMouseDown={(e) => {\r\n              e.preventDefault(); // IMPORTANT: prevents blur before click\r\n              pickName(a);\r\n            }}\r\n            style={{\r\n              padding: \"8px 10px\",\r\n              cursor: \"pointer\",\r\n              borderBottom: \"1px solid #f1f1f1\",\r\n            }}\r\n          >\r\n            <div style={{ fontWeight: 600 }}>{a.name}</div>\r\n            <div style={{ fontSize: 12, color: \"#666\" }}>\r\n              {a.mobile ? `ðŸ“± ${a.mobile}` : \"\"}\r\n              {a.city ? ` â€¢ ${a.city}` : \"\"}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    )}\r\n  </div>\r\n  <div>\r\n    <label>Mobile No.</label>\r\n    <input\r\n      type=\"tel\"\r\n      list=\"mobile-suggest\"\r\n      placeholder=\"10-digit mobile\"\r\n      value={buyer.mobile}\r\n      onChange={async (e) => {\r\n        const v = String(e.target.value).replace(/[^0-9]/g, \"\").slice(0, 10);\r\n\r\n        // update buyer mobile immediately\r\n        setBuyer((b) => ({ ...b, mobile: v }));\r\n        setMobileQuery(v);\r\n\r\n        // reset ledger if user edits mobile again\r\n        if (v.length < 10) {\r\n          setSelectedAccount(null);\r\n          setAccQuery(\"\");\r\n          return;\r\n        }\r\n\r\n        // when full 10 digits â†’ lookup\r\n        if (v.length === 10) {\r\n          try {\r\n            const acc = await apiAccountByMobile(v);\r\n            console.log(\"Lookup by mobile:\", v, acc);\r\n\r\n            if (acc) {\r\n              const normalized = {\r\n                ...acc,\r\n                name: acc.name ?? acc.account_name ?? \"\",\r\n              };\r\n\r\n              // 1ï¸âƒ£ Fill buyer details\r\n              fillBuyerFromAccount(normalized);\r\n\r\n              // 2ï¸âƒ£ Auto-assign ledger\r\n              setSelectedAccount(normalized);\r\n              setAccQuery(normalized.name);\r\n\r\n              // 3ï¸âƒ£ Close all suggestions\r\n              setAccSuggest([]);\r\n              setMobileSuggest([]);\r\n            }\r\n          } catch (err) {\r\n            console.error(\"Mobile lookup failed\", err);\r\n          }\r\n        }\r\n      }}\r\n      onBlur={async () => {\r\n        const v = (buyer.mobile || \"\").trim();\r\n\r\n        if (v.length === 10 && !selectedAccount) {\r\n          try {\r\n            const acc = await apiAccountByMobile(v);\r\n\r\n            if (acc) {\r\n              const normalized = {\r\n                ...acc,\r\n                name: acc.name ?? acc.account_name ?? \"\",\r\n              };\r\n\r\n              fillBuyerFromAccount(normalized);\r\n              setSelectedAccount(normalized);\r\n              setAccQuery(normalized.name);\r\n            }\r\n          } catch {}\r\n        }\r\n\r\n        setMobileSuggest([]);\r\n      }}\r\n    />\r\n\r\n    <datalist id=\"mobile-suggest\">\r\n      {mobileSuggest.map((a, idx) => (\r\n        <option key={`${a.mobile}-${idx}`} value={a.mobile}>\r\n          {a.name ? `${a.name} - ${a.mobile}` : a.mobile}\r\n        </option>\r\n      ))}\r\n    </datalist>\r\n  </div>  \r\n  </div>\r\n\r\n            <div className=\"row-2\">\r\n    {/* GSTIN */}\r\n    <div>\r\n      <label>GSTIN / UIN</label>\r\n      <input\r\n        value={buyer.gstin}\r\n        onChange={(e) =>\r\n          setBuyer((b) => ({ ...b, gstin: e.target.value }))\r\n        }\r\n      />\r\n    </div>\r\n\r\n    {/* ACCOUNT (LEDGER) */}\r\n    <div style={{ position: \"relative\" }}>\r\n      <label>Account (Ledger)</label>\r\n      <input\r\n        value={accQuery}\r\n        \r\n          tabIndex={-1}   \r\n          readOnly={!!selectedAccount}\r\n        onChange={(e) => {\r\n          setAccQuery(e.target.value);\r\n        //  setSelectedAccount(null);\r\n        }}\r\n        onFocus={() => {\r\n    if (accQuery.length === 0) setAccSuggest([]);\r\n  }}\r\n        placeholder=\"Search accountâ€¦\"\r\n        autoComplete=\"off\"\r\n      />\r\n\r\n      {/* Dropdown */}\r\n      {accSuggest.length > 0 && (\r\n        <div\r\n          style={{\r\n            position: \"absolute\",\r\n            top: \"100%\",\r\n            left: 0,\r\n            right: 0,\r\n            background: \"#fff\",\r\n            border: \"1px solid #ddd\",\r\n            zIndex: 60,\r\n            maxHeight: 220,\r\n            overflowY: \"auto\",\r\n            borderRadius: 8,\r\n          }}\r\n        >\r\n          {accSuggest.map((a, idx) => (\r\n            <div\r\n              key={`${a.account_id}-${idx}`}\r\n              onMouseDown={(e) => {\r\n                e.preventDefault(); // prevent blur\r\n                pickAccount(a);\r\n              }}\r\n              style={{\r\n                padding: \"8px 10px\",\r\n                cursor: \"pointer\",\r\n                borderBottom: \"1px solid #f1f1f1\",\r\n              }}\r\n            >\r\n              <div style={{ fontWeight: 600 }}>{a.name}</div>\r\n              <div style={{ fontSize: 12, color: \"#666\" }}>\r\n                ID: {a.account_id}\r\n                {a.mobile ? ` â€¢ ðŸ“± ${a.mobile}` : \"\"}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  </div>\r\n\r\n              <div className=\"row-2\">\r\n                <div>\r\n                  <label>State</label>\r\n                  <input\r\n                    value={buyer.state}\r\n                    onChange={(e) =>\r\n                      setBuyer((b) => ({ ...b, state: e.target.value }))\r\n                    }\r\n                    placeholder=\"Tamil Nadu\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label>State Code</label>\r\n                  <input\r\n                    value={buyer.stateCode}\r\n                    onChange={(e) =>\r\n                      setBuyer((b) => ({\r\n                        ...b,\r\n                        stateCode: String(e.target.value).replace(/[^0-9]/g, \"\"),\r\n                      }))\r\n                    }\r\n                    placeholder=\"33\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <label>Address 1 *</label>\r\n                <input\r\n                  value={buyer.addr1}\r\n                  onChange={(e) =>\r\n                    setBuyer((b) => ({ ...b, addr1: e.target.value }))\r\n                  }\r\n                />\r\n              </div>\r\n              <div>\r\n                <label>Address 2</label>\r\n                <input\r\n                  value={buyer.addr2}\r\n                  onChange={(e) =>\r\n                    setBuyer((b) => ({ ...b, addr2: e.target.value }))\r\n                  }\r\n                />\r\n              </div>\r\n              <div className=\"row-2\">\r\n                <div>\r\n                  <label>City *</label>\r\n                  <input\r\n                    value={buyer.city}\r\n                    onChange={(e) =>\r\n                      setBuyer((b) => ({ ...b, city: e.target.value }))\r\n                    }\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label>PIN *</label>\r\n                  <input\r\n                    value={buyer.pin}\r\n                    onChange={(e) =>\r\n                      setBuyer((b) => ({\r\n                        ...b,\r\n                        pin: String(e.target.value).replace(/[^0-9]/g, \"\"),\r\n                      }))\r\n                    }\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Consignee toggle */}\r\n        <div className=\"stack\" style={{ marginTop: 4 }}>\r\n          <label\r\n            className=\"small\"\r\n            style={{ display: \"flex\", alignItems: \"center\", gap: 8 }}\r\n          >\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={consigneeDifferent}\r\n              onChange={(e) => setConsigneeDifferent(e.target.checked)}\r\n              style={{ width: 16, height: 16 }}\r\n            />\r\n            Consignee different from Buyer?\r\n          </label>\r\n          {!consigneeDifferent && (\r\n            <span className=\"badge\">Using Buyer as Consignee</span>\r\n          )}\r\n        </div>\r\n\r\n        {/* Consignee fields */}\r\n        {consigneeDifferent && (\r\n          <div className=\"card\" style={{ marginTop: 8 }}>\r\n            <div className=\"small\">Consignee (Ship To)</div>\r\n\r\n            <div className=\"form-grid-3\" style={{ marginTop: 6 }}>\r\n              <div>\r\n                <label>Name</label>\r\n                <input\r\n                  value={consignee.name}\r\n                  onChange={(e) =>\r\n                    setConsignee((c) => ({ ...c, name: e.target.value }))\r\n                  }\r\n                />\r\n              </div>\r\n              <div>\r\n                <label>GSTIN/UIN</label>\r\n                <input\r\n                  value={consignee.gstin}\r\n                  onChange={(e) =>\r\n                    setConsignee((c) => ({ ...c, gstin: e.target.value }))\r\n                  }\r\n                />\r\n              </div>\r\n              <div>\r\n                <label>State Code</label>\r\n                <input\r\n                  value={consignee.stateCode}\r\n                  onChange={(e) =>\r\n                    setConsignee((c) => ({\r\n                      ...c,\r\n                      stateCode: String(e.target.value).replace(/[^0-9]/g, \"\"),\r\n                    }))\r\n                  }\r\n                  placeholder=\"33\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"form-grid-3\" style={{ marginTop: 6 }}>\r\n              <div>\r\n                <label>State</label>\r\n                <input\r\n                  value={consignee.state}\r\n                  onChange={(e) =>\r\n                    setConsignee((c) => ({ ...c, state: e.target.value }))\r\n                  }\r\n                  placeholder=\"Tamil Nadu\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label>City</label>\r\n                <input\r\n                  value={consignee.city}\r\n                  onChange={(e) =>\r\n                    setConsignee((c) => ({ ...c, city: e.target.value }))\r\n                  }\r\n                />\r\n              </div>\r\n              <div>\r\n                <label>PIN</label>\r\n                <input\r\n                  value={consignee.pin || \"\"}\r\n                  onChange={(e) =>\r\n                    setConsignee((c) => ({\r\n                      ...c,\r\n                      pin: String(e.target.value).replace(/[^0-9]/g, \"\"),\r\n                    }))\r\n                  }\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ marginTop: 6 }}>\r\n              <label>Address 1</label>\r\n              <input\r\n                value={consignee.addr1}\r\n                onChange={(e) =>\r\n                  setConsignee((c) => ({ ...c, addr1: e.target.value }))\r\n                }\r\n                style={{ width: \"100%\" }}\r\n              />\r\n            </div>\r\n\r\n            <div style={{ marginTop: 6 }}>\r\n              <label>Address 2</label>\r\n              <input\r\n                value={consignee.addr2}\r\n                onChange={(e) =>\r\n                  setConsignee((c) => ({ ...c, addr2: e.target.value }))\r\n                }\r\n                style={{ width: \"100%\" }}\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Items table */}\r\n        <div className=\"card\" style={{ marginTop: 12 }}>\r\n          <table\r\n            className=\"items-table\"\r\n            style={{ width: \"100%\", tableLayout: \"fixed\" }}\r\n          >\r\n            <colgroup>\r\n              <col style={{ width: 44 }} />\r\n              <col />\r\n              <col style={{ width: 100 }} />\r\n              <col style={{ width: 84 }} />\r\n              <col style={{ width: 72 }} />\r\n              <col style={{ width: 96 }} />\r\n              <col style={{ width: 108 }} />\r\n              <col style={{ width: 84 }} />\r\n              <col style={{ width: 116 }} />\r\n              <col style={{ width: 56 }} />\r\n            </colgroup>\r\n\r\n            <thead>\r\n              <tr>\r\n                <th>#</th>\r\n                <th>Description of Goods</th>\r\n                <th>HSN</th>\r\n                <th className=\"right\">Qty</th>\r\n                <th className=\"center\">Unit</th>\r\n                <th className=\"right\">Rate</th>\r\n                <th className=\"right\">Price</th>\r\n                <th className=\"right\">GST %</th>\r\n                <th className=\"right\">Amount</th>\r\n                <th className=\"center\">âœ–</th>\r\n              </tr>\r\n            </thead>\r\n\r\n            <tbody>\r\n              {lines.map((l, i) => {\r\n                const qty = Number(l.qty || 0);\r\n                const rate = Number(l.unitPrice || 0);\r\n                const gstPct = Number(l.gst || 0);\r\n                const price = qty * rate;\r\n                const st = statuses[i];\r\n\r\n                const disableRowInputs =\r\n                  !!st &&\r\n                  (!st.exists ||\r\n                    (typeof st.stock === \"number\" && st.stock <= 0));\r\n\r\n                return (\r\n                  <tr key={i}>\r\n                    <td>{i + 1}</td>\r\n                    <td>\r\n                      <input\r\n                        list=\"bill-suggest\"\r\n                        placeholder=\"Type to search Purchasesâ€¦\"\r\n                        value={l.itemName}\r\n                        onChange={(e) => handleItemChange(i, e.target.value)}\r\n                        onFocus={(e) =>\r\n                          setActiveQuery(e.target.value || \" \")\r\n                        }\r\n                      />\r\n                      <datalist id=\"bill-suggest\">\r\n                        {suggest.map((s, idx) => (\r\n                          <option\r\n                            key={`${s.name}-${idx}`}\r\n                            value={s.name}\r\n                          />\r\n                        ))}\r\n                      </datalist>\r\n                      {l.itemName && st && (\r\n                        <div\r\n                          className=\"small\"\r\n                          style={{\r\n                            color:\r\n                              st.exists &&\r\n                              Number(l.qty || 0) <= st.stock\r\n                                ? \"#047857\"\r\n                                : \"#b91c1c\",\r\n                          }}\r\n                        >\r\n                          {!st.exists && \"Not available in Inventory\"}\r\n                          {st.exists &&\r\n                            st.stock === 0 &&\r\n                            \"Out of stock\"}\r\n                          {st.exists &&\r\n                            st.stock > 0 &&\r\n                            Number(l.qty || 0) === 0 &&\r\n                            `In stock: ${st.stock}`}\r\n                          {st.exists &&\r\n                            Number(l.qty || 0) > st.stock &&\r\n                            `Only ${st.stock} in stock`}\r\n                          {st.exists &&\r\n                            Number(l.qty || 0) > 0 &&\r\n                            Number(l.qty || 0) <= st.stock &&\r\n                            `Available: ${st.stock}`}\r\n                        </div>\r\n                      )}\r\n                    </td>\r\n\r\n                    <td>\r\n                      <input\r\n                        value={l.hsn}\r\n                        onChange={(e) => handleHSN(i, e.target.value)}\r\n                        disabled={disableRowInputs}\r\n                      />\r\n                    </td>\r\n\r\n                    <td className=\"right\">\r\n                      <input\r\n                        value={l.qty}\r\n                        onChange={(e) => handleQty(i, e.target.value)}\r\n                        onBlur={(e) =>\r\n                          updateAvailability(\r\n                            i,\r\n                            l.itemName,\r\n                            e.target.value\r\n                          )\r\n                        }\r\n                        disabled={disableRowInputs}\r\n                      />\r\n                    </td>\r\n\r\n                    <td className=\"center\">\r\n                      <input value=\"KG\" readOnly />\r\n                    </td>\r\n\r\n                    <td className=\"right\">\r\n                      <input\r\n                        value={l.unitPrice}\r\n                        onChange={(e) => handlePrice(i, e.target.value)}\r\n                        disabled={disableRowInputs}\r\n                      />\r\n                    </td>\r\n\r\n                    <td className=\"right\">{toINR(price)}</td>\r\n\r\n                    <td className=\"right\">\r\n                      <input\r\n                        value={l.gst}\r\n                        onChange={(e) => handleGST(i, e.target.value)}\r\n                        disabled={disableRowInputs}\r\n                      />\r\n                    </td>\r\n\r\n                    <td className=\"right\">\r\n                      {toINR(price + (price * gstPct) / 100)}\r\n                    </td>\r\n\r\n                    <td className=\"center\">\r\n                      <button\r\n                        className=\"btn warn\"\r\n                        onClick={() => removeRow(i)}\r\n                      >\r\n                        Del\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n            </tbody>\r\n\r\n            <tfoot>\r\n              <tr>\r\n                <td colSpan={10}>\r\n                  <div className=\"stack\">\r\n                    <button className=\"btn\" onClick={addRow}>\r\n                      + Add Item\r\n                    </button>\r\n                    <div className=\"muted\">\r\n                      Type to search from <b>Purchases</b>. Unit is fixed\r\n                      to <b>KG</b>; Rate &amp; GST% auto-fill from the\r\n                      latest Purchase; HSN from Inventory.\r\n                    </div>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            </tfoot>\r\n          </table>\r\n        </div>\r\n\r\n        {/* Totals + payments */}\r\n        <div className=\"totals-grid\">\r\n          <div />\r\n          <div className=\"card\" style={{ padding: 12 }}>\r\n            <div\r\n              className=\"row\"\r\n              style={{ gridTemplateColumns: \"1fr 1fr\", margin: 0 }}\r\n            >\r\n              <div className=\"small\">Taxable Amount</div>\r\n              <div className=\"right\">\r\n                <b>{toINR(computed.taxable)}</b>\r\n              </div>\r\n\r\n              <div\r\n                className=\"small\"\r\n                style={{ display: \"flex\", alignItems: \"center\", gap: 8 }}\r\n              >\r\n                Discount (%)\r\n              </div>\r\n              <div className=\"right\">\r\n                <input\r\n                  value={discountPct}\r\n                  onChange={(e) =>\r\n                    setDiscountPct(\r\n                      String(e.target.value).replace(/[^0-9.]/g, \"\")\r\n                    )\r\n                  }\r\n                  style={{ width: 120, textAlign: \"right\" }}\r\n                  placeholder=\"0\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"small\">Discount Amount</div>\r\n              <div className=\"right\">\r\n                -{toINR(computed.discountAmount)}\r\n              </div>\r\n\r\n              <div className=\"small\">\r\n                {isInterState ? \"GST (IGST)\" : \"GST (CGST+SGST)\"}\r\n              </div>\r\n              <div className=\"right\">\r\n                <b>\r\n                  {isInterState\r\n                    ? toINR(computed.igstRounded)\r\n                    : toINR(\r\n                        computed.cgstRounded + computed.sgstRounded\r\n                      )}\r\n                </b>\r\n              </div>\r\n\r\n              <div className=\"small\">Round Off (GST rounding)</div>\r\n              <div className=\"right\">\r\n                {toINR(computed.roundOff)}\r\n              </div>\r\n\r\n              <div className=\"small\">Total</div>\r\n              <div className=\"right\">\r\n                <b>{toINR(computed.total)}</b>\r\n              </div>\r\n\r\n              <div className=\"small\" style={{ marginTop: 6 }}>\r\n                <b>Grand Total</b>\r\n              </div>\r\n              <div className=\"right\" style={{ marginTop: 6 }}>\r\n                <b>{toINR(computed.grand)}</b>\r\n              </div>\r\n\r\n              {/* Advance / Partial Payment field hidden */}\r\n              {/* \r\n              <div className=\"small\" style={{ marginTop: 8 }}>\r\n                Advance / Partial Payment\r\n              </div>\r\n              <div className=\"right\" style={{ marginTop: 8 }}>\r\n                <input\r\n                  value={advance}\r\n                  onChange={(e) =>\r\n                    setAdvance(\r\n                      String(e.target.value).replace(/[^0-9]/g, \"\")\r\n                    )\r\n                  }\r\n                  style={{ width: 120, textAlign: \"right\" }}\r\n                  placeholder=\"0\"\r\n                />\r\n              </div>\r\n              */}\r\n\r\n              <div className=\"small\">Terms of Payment</div>\r\n              <div className=\"right\">\r\n                <select\r\n                  value={paymentMode}\r\n                  onChange={(e) => setPaymentMode(e.target.value)}\r\n                  style={{ width: 140, textAlign: \"right\" }}\r\n                >\r\n                  <option value=\"\">Select</option>\r\n                  {paymentModes.map((m) => (\r\n                    <option key={\"pm-\" + m}>{m}</option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            <div className=\"small\">Payment Receipt No.</div>\r\n            <div className=\"right\">\r\n              <textarea\r\n                value={paymentReceiptNo}\r\n                onChange={(e) => setPaymentReceiptNo(e.target.value)}\r\n                placeholder=\"Enter receipt / UTR / cheque / reference number\"\r\n                rows={2}\r\n                style={{\r\n                  width: \"100%\",\r\n                  resize: \"vertical\",\r\n                  textAlign: \"left\",\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            </div>\r\n\r\n            {/* Split Payments */}\r\n            <hr />\r\n            <div\r\n              className=\"row\"\r\n              style={{ gridTemplateColumns: \"1fr 1fr\", marginTop: 6 }}\r\n            >\r\n              <div\r\n                className=\"small\"\r\n                style={{ display: \"flex\", alignItems: \"center\", gap: 8 }}\r\n              >\r\n                Split Payment (max 2)\r\n              </div>\r\n              <div className=\"right\">\r\n                <label\r\n                  style={{\r\n                    display: \"inline-flex\",\r\n                    gap: 8,\r\n                    alignItems: \"center\",\r\n                  }}\r\n                >\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={splitEnabled}\r\n                    onChange={(e) => setSplitEnabled(e.target.checked)}\r\n                  />\r\n                  <span className=\"small\">Enable</span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n\r\n            {splitEnabled && (\r\n              <>\r\n                <div\r\n                  className=\"grid grid-3\"\r\n                  style={{\r\n                    display: \"grid\",\r\n                    gridTemplateColumns: \"1fr 1fr 1fr\",\r\n                    gap: 8,\r\n                    marginTop: 8,\r\n                  }}\r\n                >\r\n                  <div>\r\n                    <label>Split #1 Amount</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      value={split1.amount}\r\n                      onChange={(e) => {\r\n                        const raw = String(e.target.value);\r\n                        const clean = raw.replace(/[^0-9.]/g, \"\");\r\n                        const amt1 = n(clean);\r\n                        const remaining = Math.max(\r\n                          0,\r\n                          +(computed.grand - amt1).toFixed(2)\r\n                        );\r\n                        setSplit1({ ...split1, amount: clean });\r\n                        setSplit2((prev) => ({\r\n                          ...prev,\r\n                          amount:\r\n                            remaining > 0\r\n                              ? String(remaining)\r\n                              : remaining === 0\r\n                              ? \"0\"\r\n                              : prev.amount,\r\n                        }));\r\n                      }}\r\n                      placeholder=\"0\"\r\n                      className=\"right\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label>Split #1 Terms / Mode</label>\r\n                    <select\r\n                      value={split1.mode}\r\n                      onChange={(e) =>\r\n                        setSplit1({ ...split1, mode: e.target.value })\r\n                      }\r\n                    >\r\n                      {paymentModes.map((m) => (\r\n                        <option key={\"m1\" + m} value={m}>\r\n                          {m}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label>Ref / Txn No. (opt)</label>\r\n                    <input\r\n                      value={split1.ref}\r\n                      onChange={(e) =>\r\n                        setSplit1({ ...split1, ref: e.target.value })\r\n                      }\r\n                      placeholder=\"UTR / Cheque / Last 4\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div\r\n                  className=\"grid grid-3\"\r\n                  style={{\r\n                    display: \"grid\",\r\n                    gridTemplateColumns: \"1fr 1fr 1fr\",\r\n                    gap: 8,\r\n                    marginTop: 8,\r\n                  }}\r\n                >\r\n                  <div>\r\n                    <label>Split #2 Amount</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      value={split2.amount}\r\n                      onChange={(e) =>\r\n                        setSplit2({ ...split2, amount: e.target.value })\r\n                      }\r\n                      placeholder=\"0\"\r\n                      className=\"right\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label>Split #2 Terms / Mode</label>\r\n                    <select\r\n                      value={split2.mode}\r\n                      onChange={(e) =>\r\n                        setSplit2({ ...split2, mode: e.target.value })\r\n                      }\r\n                    >\r\n                      {paymentModes.map((m) => (\r\n                        <option key={\"m2\" + m} value={m}>\r\n                          {m}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label>Ref / Txn No. (opt)</label>\r\n                    <input\r\n                      value={split2.ref}\r\n                      onChange={(e) =>\r\n                        setSplit2({ ...split2, ref: e.target.value })\r\n                      }\r\n                      placeholder=\"UTR / Cheque / Last 4\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div\r\n                  className=\"row\"\r\n                  style={{\r\n                    gridTemplateColumns: \"1fr 1fr\",\r\n                    marginTop: 8,\r\n                  }}\r\n                >\r\n                  <div className=\"small\">\r\n                    Paid Now (Advance + Splits)\r\n                  </div>\r\n                  <div className=\"right\">{toINR(paidNow)}</div>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* SAVE & PRINT */}\r\n        <div className=\"actions-row\">\r\n          <button\r\n            className=\"btn\"\r\n            onClick={async () => {\r\n              const missing = [];\r\n              if (!buyer.name.trim()) missing.push(\"Buyer Name\");\r\n              if (!buyer.addr1.trim()) missing.push(\"Buyer Address 1\");\r\n              if (!buyer.city.trim()) missing.push(\"Buyer City\");\r\n              if (!buyer.pin?.trim?.()) missing.push(\"Buyer PIN\");\r\n              console.log(\"Selected Account:\", selectedAccount);\r\n              if (!selectedAccount?.account_id) {\r\n                alert(\"Please select Account (Ledger) before saving.\");\r\n              return;\r\n    }\r\n\r\n\r\n              if (missing.length) {\r\n                alert(\r\n                  \"Please fill mandatory fields:\\n\" + missing.join(\"\\n\")\r\n                );\r\n                return;\r\n              }\r\n\r\n              const issues = [];\r\n              lines.forEach((l, i) => {\r\n                if (!l.itemName || !Number(l.qty)) return;\r\n                const st = statuses[i];\r\n                if (!st?.exists)\r\n                  issues.push(\r\n                    `Row ${i + 1}: Item not found in inventory`\r\n                  );\r\n                else if (!st?.can_deliver)\r\n                  issues.push(\r\n                    `Row ${i + 1}: Only ${st.stock} in stock`\r\n                  );\r\n              });\r\n              if (issues.length) {\r\n                alert(\"Please fix before saving:\\n\" + issues.join(\"\\n\"));\r\n                return;\r\n              }\r\n\r\n              if (!computed.rows.length) {\r\n                alert(\"No valid line items to save.\");\r\n                return;\r\n              }\r\n\r\n  const salePayload = {\r\n    bill_no: invMeta.invoiceNo,\r\n    date: invMeta.date,\r\n    account_id: selectedAccount.account_id,\r\n    party_name: buyer.name || \"\",\r\n    invoice_type: invoiceType,\r\n\r\n    // ðŸšš TRANSPORT / E-WAY DETAILS (ADD THIS)\r\n    eway_no: invMeta.ewayNo || \"\",\r\n    vehicle_no: invMeta.vehicleNo || \"\",\r\n    kms: invMeta.kms ? Number(invMeta.kms) : null,\r\n    from_date: invMeta.fromDate || null,\r\n    to_date: invMeta.toDate || null,\r\n\r\n    // totals\r\n    taxable: +computed.taxable.toFixed(2),\r\n    discount_amount: +computed.discountAmount.toFixed(2),\r\n    discounted_taxable: +computed.discountedTaxable.toFixed(2),\r\n    gst_amount: +computed.gstRounded.toFixed(2),\r\n    round_off: +computed.roundOff.toFixed(2),\r\n    grand_total: +computed.grand.toFixed(2),\r\n\r\n    paid_now: +paidNow.toFixed(2),\r\n    balance: +balanceAfterSplits.toFixed(2),\r\n\r\n    payment_mode: paymentMode || \"\",\r\n    payment_receipt_no: paymentReceiptNo || \"\",\r\n\r\n    // items\r\n    items: computed.rows.map((r) => ({\r\n      item_name: r.itemName,\r\n      hsn: r.hsn || \"\",\r\n      qty: Number(r.qty || 0),\r\n      unit: r.unit || \"KG\",\r\n      price: Number(r.rate || 0),\r\n      gst: Number(r.gstRate || r.gst || 0),\r\n    })),\r\n  };\r\n\r\n\r\n\r\n              try {\r\n                const resp = await apiCreateSaleFIFO(salePayload);\r\n                // Optional: you can log / show resp.sale_id, resp.total_amount, etc.\r\n                console.log(\"Sale created (FIFO):\", resp);\r\n              } catch (e) {\r\n                console.error(\"Error creating sale via FIFO:\", e);\r\n                alert(\r\n                  \"Failed to create sale in database (FIFO).\\n\" +\r\n                    (e?.message || e)\r\n                );\r\n                return;\r\n              }\r\n\r\n              // 2) Local storage copy (for your own dashboard/history)\r\n              const bill = {\r\n                id: Date.now(),\r\n                account_id: selectedAccount.account_id,\r\n                account_name: selectedAccount.name,\r\n                account_mobile: selectedAccount.mobile || buyer.mobile || \"\",\r\n                company,\r\n                buyer,\r\n                consignee: consigneeDifferent ? consignee : buyer,\r\n                invMeta,\r\n                lines,\r\n                computed,\r\n                discountPct,\r\n                advance,\r\n                paymentMode,\r\n                payments: {\r\n                  splitEnabled,\r\n                  split1: splitEnabled\r\n                    ? {\r\n                        amount: n(split1.amount),\r\n                        mode: split1.mode,\r\n                        ref: split1.ref,\r\n                      }\r\n                    : null,\r\n                  split2: splitEnabled\r\n                    ? {\r\n                        amount: n(split2.amount),\r\n                        mode: split2.mode,\r\n                        ref: split2.ref,\r\n                      }\r\n                    : null,\r\n                  paidNow,\r\n                  balance: balanceAfterSplits,\r\n                },\r\n                createdAt: new Date().toISOString(),\r\n              };\r\n              const arr = JSON.parse(\r\n                localStorage.getItem(\"bills.v2\") || \"[]\"\r\n              );\r\n              arr.push(bill);\r\n              localStorage.setItem(\"bills.v2\", JSON.stringify(arr));\r\n\r\n              // 3) Export + Print\r\n              exportExcel();\r\n              printNow();\r\n            }}\r\n          >\r\n            Save\r\n          </button>\r\n\r\n          <button className=\"btn primary\" onClick={printNow}>\r\n            Print\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}